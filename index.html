<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æˆ‘ä¸æƒ³åŠªåŠ›äº†</title>
  
  <!-- å¼•å…¥ xlsx.js å‡½å¼åº«ï¼Œç”¨æ–¼è™•ç† Excel æª”æ¡ˆ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- å¼•å…¥ Supabase.js å‡½å¼åº« -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- å¼•å…¥ Chart.js åœ–è¡¨åº« -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- å¼•å…¥ Google Fonts çš„ LXGW WenKai TC (éœé¶©æ–‡æ¥· TC) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&display=swap" rel="stylesheet">

<style>
/* âœ… æ–°å¢ï¼šå°ˆæ¡ˆè³‡è¨ŠæŒ‰éˆ•æ¨£å¼ (åœ“è§’è† å›Š + å¯é»æ“Š) */
.project-header-info {
  /* ä½ç½® */
  margin-top: 0.6rem; 
  align-self: flex-start;

  /* å½¢ç‹€èˆ‡é¡è‰² (è·Ÿç•ª Header å…¶ä»–æŒ‰éˆ•é¢¨æ ¼) */
  background-color: rgba(0, 0, 0, 0.15); /* æ·±è‰²åŠé€æ˜åº• */
  border: 1px solid rgba(255, 255, 255, 0.3); /* æ·ºè‰²é‚Šæ¡† */
  border-radius: 999px; /* åœ“è§’è† å›Šå½¢ */
  padding: 0.4rem 1rem; 
  
  /* å­—é«” */
  font-size: 0.95rem;
  color: #ffffff;
  
  /* æ’ç‰ˆ */
  display: inline-flex;
  gap: 0.6rem;
  align-items: center;
  backdrop-filter: blur(4px);
  
  /* äº’å‹•æ„Ÿ (è®ŠæˆæŒ‰éˆ•çš„é—œéµ) */
  cursor: pointer; 
  transition: all 0.2s ease;
  user-select: none; /* é˜²æ­¢é¸å–æ–‡å­— */
}

/* æ»‘é¼ æŒ‡ä½æ™‚çš„æ•ˆæœ */
.project-header-info:hover {
  background-color: rgba(0, 0, 0, 0.3); /* è®Šæ·±è‰² */
  transform: translateY(-1px); /* è¼•å¾®æµ®èµ· */
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  border-color: rgba(255, 255, 255, 0.6);
}

/* æŒ‰ä¸‹å»æ™‚çš„æ•ˆæœ */
.project-header-info:active {
  transform: translateY(0);
  background-color: rgba(0, 0, 0, 0.4);
}

.project-header-info span {
  display: inline-block;
  white-space: nowrap;
  max-width: 300px;
  overflow: hidden;
  text-overflow: ellipsis;
}

#ph-class {
    font-weight: bold;
    color: #fff; 
}

.project-header-info .ph-divider {
  opacity: 0.5;
  margin: 0 2px;
}

/* ========================================= */
/* === [Pro-v7.5] Pop Art å½ˆçª—æ¨£å¼ (çµ‚æ¥µä¿®å¾©ç‰ˆ) === */
/* ========================================= */

/* 1. åº•ç´™ (Overlay) - ç¢ºä¿è¦†è“‹å…¨è¢å¹•ï¼Œé–æ­»èƒŒæ™¯ */
.pop-overlay {
  position: fixed; /* æ‡¸æµ®å®šä½ï¼Œç„¡è¦–é é¢æ²å‹• */
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  
  /* èƒŒæ™¯é¡è‰²èˆ‡æ¨¡ç³Š */
  background: rgba(105, 129, 118, 0.6);
  backdrop-filter: blur(5px); /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ */
  
  /* å½ˆçª—ç½®ä¸­æ ¸å¿ƒ (Flexbox) */
  display: flex;
  justify-content: center; /* æ°´å¹³ç½®ä¸­ */
  align-items: center;     /* å‚ç›´ç½®ä¸­ */
  
  z-index: 2147483647; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
  
  /* é è¨­éš±è— */
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease;
}

/* é¡¯ç¤ºæ™‚çš„ç‹€æ…‹ */
.pop-overlay.active {
  opacity: 1;
  pointer-events: auto;
}

/* 2. å½ˆçª—æœ¬é«” (Modal) - è‡ªå‹•é©æ‡‰å¤§å° */
.pop-modal {
  background: #ffffff;
  
  /* å¯¬åº¦æ§åˆ¶ */
  width: 90%;
  max-width: 460px; /* é›»è…¦ç‰ˆä¸æœƒå¤ªé—Š */
  
  /* é«˜åº¦æ§åˆ¶ï¼šæœ€å¤šä½”è¢å¹• 85%ï¼Œå…§å®¹å¤šæ™‚å…§éƒ¨æ²å‹• */
  max-height: 85vh;
  display: flex;
  flex-direction: column; /* è®“ Header/Body/Footer å‚ç›´æ’åˆ— */
  
  /* å¤–è§€è£é£¾ */
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3); /* æ·±é‚ƒé™°å½± */
  border: 4px solid #F2C037; /* Pop Art é»ƒè‰²ç²—æ¡† */
  padding: 24px;
  
  /* æ–‡å­—è¨­å®š */
  text-align: center;
  color: #4a4a4a;
  
  /* é€²å…¥å‹•ç•« */
  transform: scale(0.9);
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative; /* ç¢ºä¿å…§éƒ¨å…ƒä»¶å®šä½æ­£å¸¸ */
}

/* å½ˆçª—é¡¯ç¤ºæ™‚çš„æ”¾å¤§å‹•ç•« */
.pop-overlay.active .pop-modal {
  transform: scale(1);
}

/* 3. å½ˆçª—å…§éƒ¨å…ƒä»¶ */

.pop-icon {
  font-size: 36px;
  margin-bottom: 8px;
  display: block;
}

.pop-modal h3 {
  margin: 0 0 10px 0;
  font-size: 1.4rem;
  color: #333;
  font-weight: 700;
  flex-shrink: 0; /* é˜²æ­¢æ¨™é¡Œè¢«å£“ç¸® */
}

.pop-desc {
  font-size: 0.95rem;
  color: #666;
  margin-bottom: 15px;
  line-height: 1.5;
  flex-shrink: 0;
}

/* æ²å‹•å€åŸŸ (å¦‚å°ˆæ¡ˆåˆ—è¡¨ã€å­¸ç”Ÿåˆ—è¡¨) */
.pop-scroll-area {
  text-align: left;
  background: #fffdf5;
  border-radius: 12px;
  padding: 10px;
  
  /* é—œéµï¼šè®“å®ƒä½”æ“šå‰©é¤˜ç©ºé–“ï¼Œä½†æœ‰æœ€å¤§é«˜åº¦ */
  flex: 1; 
  overflow-y: auto; /* è¶…å‡ºæ™‚é¡¯ç¤ºæ²è»¸ */
  min-height: 100px; /* è‡³å°‘æœ‰å°‘å°‘é«˜åº¦ */
  
  margin-bottom: 20px;
  border: 2px solid #eee;
}

/* 1. ä¿®æ­£ã€Œè¼‰å…¥é è¨­è©•èªã€Pop-up æ’ç‰ˆ */
.pop-list-item {
    display: flex !important;
    align-items: center !important;
    text-align: left !important;
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 8px;
    padding: 10px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
}
.pop-list-item input[type="checkbox"] {
    margin-right: 10px !important;
    flex-shrink: 0; /* é˜²æ­¢ Checkbox è¢«å£“æ‰ */
    width: 1.2rem;
    height: 1.2rem;
}

.pop-list-item:hover {
  background-color: #fcf4d6;
  color: #333;
}

/* è¼¸å…¥æ¡† */
.pop-input {
  width: 100%; /* æ”¹ç‚º 100% å¡«æ»¿å®¹å™¨ */
  box-sizing: border-box; /* ç¢ºä¿ padding ä¸æœƒæ’çˆ†å¯¬åº¦ */
  padding: 12px 15px;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  font-size: 16px; /* é˜²æ­¢ iOS æ”¾å¤§ */
  outline: none;
  text-align: left; /* ä¸€èˆ¬è¼¸å…¥é å·¦è¼ƒå¥½çœ‹ */
  transition: border-color 0.3s;
  font-family: inherit;
  margin-bottom: 15px;
  display: block;
}

.pop-input:focus {
  border-color: #F2C037;
  background-color: #fffdf8;
}

/* æŒ‰éˆ•å€åŸŸ */
.pop-footer {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */
  flex-shrink: 0;
}

.pop-btn {
  padding: 10px 24px;
  border: none;
  border-radius: 99px;
  font-size: 1rem;
  font-weight: bold;
  cursor: pointer;
  font-family: inherit;
  transition: transform 0.1s, opacity 0.2s;
  flex: 1; /* æŒ‰éˆ•å¹³å‡åˆ†é…å¯¬åº¦ */
  max-width: 150px;
}

.pop-btn:active {
  transform: scale(0.96);
}

.pop-btn-cancel {
  background: #f0f0f0;
  color: #666;
}

.pop-btn-confirm {
  background: #F2C037;
  color: #fff;
  box-shadow: 0 4px 12px rgba(242, 192, 55, 0.4);
}
.pop-btn-confirm:hover {
  background: #e0b132;
}

/* æ‰‹æ©Ÿç‰ˆé©é… (é˜²æ­¢éµç›¤å½ˆå‡ºæ™‚é®æ“‹) */
@media (max-height: 600px) {
  .pop-modal {
    max-height: 95vh;
    padding: 15px;
  }
  .pop-icon {
    display: none; /* è¢å¹•çŸ®æ™‚éš±è— icon çœä½ */
  }
}


  /* --- æ–‡é’é¢¨è‰²å½©èˆ‡å­—é«”å®šç¾© --- */
  :root {
    --primary-bg: #f7f3eb;       /* ä¸»èƒŒæ™¯è‰² - æº«æ½¤ç±³ç™½åç° */
    --secondary-bg: #fcfaf6;     /* å¡ç‰‡èƒŒæ™¯ - æŸ”å’Œå¥¶æ²¹ç™½ */
    --text-color: #5b5044;       /* ä¸»è¦æ–‡å­— - æ·±å•¡ç° */
    --border-color: #e1d8c8;     /* é‚Šæ¡†è‰² - æ·ºäºéº»è‰² */
    --accent-color: #5A8F7B;     /* ä¸»é¡Œè‰²/å¼·èª¿è‰² - æ²‰éœç°ç¶  */
    --accent-color-soft: #cfe3d9;
    --title-color: #3d5c4f;      /* æ¨™é¡Œè‰² - æ·±ç°ç¶  */
    --header-bg: linear-gradient(120deg, #5A8F7B, #93b8a5); /* é é¦–èƒŒæ™¯æ¼¸å±¤ */
    --nav-bg: #f1ece4;           /* å°èˆªèƒŒæ™¯ - äºéº»è‰² */
    --nav-active-bg: #5A8F7B;    /* å°èˆªå•Ÿç”¨èƒŒæ™¯ - ä¸»é¡Œè‰² */
    --nav-active-color: #fff;    /* å°èˆªå•Ÿç”¨æ–‡å­— - ç™½è‰² */
    --problem-color: #c86a5a;    /* å•é¡Œ/å¾…æ”¹é€² - æŸ”å’Œç£šç´… */
    --excellent-color: #7a9e78;  /* å„ªé»/ä½³ä½œ - æ²‰ç©©æ©„æ¬–ç¶  */
    --copy-success-bg: #5f9f80;  /* è¤‡è£½æˆåŠŸ - ç¨äº®ç¶ è‰² */
    --modal-bg: rgba(0,0,0,0.28);
    --modal-card-bg: #fffdf8;
    --shadow-color: rgba(52, 43, 32, 0.10); /* é™°å½±é¡è‰² */
    --btn-brown-bg: #a18b73;     /* å•¡è‰²æŒ‰éˆ•èƒŒæ™¯ */
    --btn-brown-hover: #8f7a63;
    --dashed-box-bg: #f9fbff;    /* è™›ç·šæ¡†èƒŒæ™¯è‰² */
    --empty-state-bg: #f7f2ea;   /* ç©ºç‹€æ…‹èƒŒæ™¯è‰² */
    --empty-state-text: #93897a; /* ç©ºç‹€æ…‹æ–‡å­—é¡è‰² */
    --missing-bg: #fff0f0;       /* æœªå¡«å¯«å­¸ç”ŸèƒŒæ™¯è‰² - æ·¡ç²‰ç´… */
    --missing-text: #c86a5a;     /* æœªå¡«å¯«å­¸ç”Ÿæ–‡å­—é¡è‰² */
    --danger-bg-soft: #fef2f2;
    --danger-border-soft: #fecaca;

    --radius-lg: 14px;
    --radius-md: 10px;
    --radius-sm: 6px;
    --transition-fast: 0.18s ease-out;
    --transition-normal: 0.25s ease-out;
  }
  
  html { 
    scroll-behavior: smooth; 
    font-size: 16px;
  }

  body {
    font-family: 'LXGW WenKai TC', -apple-system, BlinkMacSystemFont, "Segoe UI",
                 system-ui, sans-serif;
    line-height: 1.7;
    letter-spacing: 0.04em;
    background: radial-gradient(circle at top left, #faf3e4, #f5f3ef 55%, #f1f5f4);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    font-size: 1rem;
  }

  /* ===== å®¹å™¨ & Header ===== */

  .main-container { 
    max-width: 1200px;
    margin: 2rem auto 2.5rem; 
    background-color: var(--secondary-bg); 
    box-shadow: 0 18px 45px var(--shadow-color); 
    border-radius: 20px; 
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.7);
    backdrop-filter: blur(10px);
    position: relative; /* æ–°å¢ï¼Œç‚ºæ‡¸æµ®å°è¦½æä¾›ç›¸å°å®šä½ï¼ˆé›–ç„¶ç›®å‰ç”¨fixedï¼‰ */
  }

  .sticky-top-bar {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: var(--secondary-bg);
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }

  
  
  .auth-container {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 0.4rem 0.6rem;
    border-radius: 999px;
    box-shadow: 0 0 0 1px rgba(255,255,255,0.25);
    flex-shrink: 0;
  }

  #auth-status {
    font-size: 0.8rem;
    padding: 0.3rem 0.8rem;
    background-color: rgba(0,0,0,0.15);
    border-radius: 999px;
    white-space: nowrap;
  }

  #auth-buttons {
    display: flex;
    gap: 0.5rem;
  }

  #auth-buttons .btn {
    padding: 0.4rem 1rem;
    font-size: 0.85rem;
    border: 1px solid rgba(255,255,255,0.7);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
  #auth-buttons .btn:hover {
    background-color: rgba(255,255,255,0.2);
  }
  #sync-btn.dirty {
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0% { box-shadow: 0 4px 8px rgba(41,81,64,0.3), 0 0 0 0 rgba(255, 255, 255, 0.7); }
    70% { box-shadow: 0 4px 12px rgba(41,81,64,0.4), 0 0 0 10px rgba(255, 255, 255, 0); }
    100% { box-shadow: 0 4px 8px rgba(41,81,64,0.3), 0 0 0 0 rgba(255, 255, 255, 0); }
  }

  /* ===== å­—é«”æ§åˆ¶ ===== */

  .font-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background-color: rgba(255,255,255,0.12);
    padding: 0.3rem 0.4rem;
    border-radius: 999px;
    box-shadow: 0 0 0 1px rgba(255,255,255,0.35);
  }

  .font-control-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.7);
    color: white;
    border-radius: 999px;
    cursor: pointer;
    font-family: inherit;
    font-size: 0.9rem;
    width: 2.35rem;
    height: 2.35rem;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform var(--transition-fast), box-shadow var(--transition-fast),
                background-color var(--transition-fast), border-color var(--transition-fast);
    box-shadow: 0 5px 10px rgba(0,0,0,0.15);
  }

  .font-control-btn:hover {
    background-color: rgba(255,255,255,0.18);
    box-shadow: 0 7px 14px rgba(0,0,0,0.22);
    transform: translateY(-1px);
  }

  .font-control-btn:active {
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 3px 7px rgba(0,0,0,0.2);
  }

  h2 { 
    color: var(--title-color); 
    border-bottom: 1px solid rgba(90,143,123,0.25); 
    padding-bottom: 0.75rem; 
    margin-top: 0; 
    font-weight: 500; 
    font-size: 1.8rem; 
  }
  h3 { 
    color: var(--title-color); 
    font-weight: 500; 
    font-size: 1.45rem; 
  }

  /* ===== ä¸Šæ–¹å°èˆª tabs ===== */


/* è¨­å®šæ£å®¹å™¨ (Desktop) */
.header-settings-wrapper {
  position: relative;
}






/* 3. ç¬¬äºŒå±¤ï¼šæ‡¸æµ®å³¶ (Floating Island) */
.sub-nav-island {
  position: absolute;
  top: 65px; /* æµ®åœ¨ Main Nav ä¸‹æ–¹å°‘å°‘ */
  left: 50%;
  transform: translateX(-50%); /* æ°´å¹³ç½®ä¸­ */
  
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.5);
  box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  
  padding: 6px 8px;
  border-radius: 99px; /* è† å›Šå½¢ç‹€ */
  
  display: flex;
  gap: 5px;
  z-index: 1001; /* æ¯” Main Nav é«˜ */
  
  /* å‹•ç•« */
  animation: floatDown 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
  white-space: nowrap;
}

@keyframes floatDown {
  from { opacity: 0; transform: translate(-50%, -10px); }
  to { opacity: 1; transform: translate(-50%, 0); }
}

.sub-nav-group {
  display: flex;
  gap: 5px;
}

.sub-nav-btn {
  padding: 6px 16px;
  font-size: 0.9rem;
  color: #666;
  background: transparent;
  border: none;
  border-radius: 99px;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
  white-space: nowrap;
}

.sub-nav-btn:hover {
  background-color: rgba(0,0,0,0.05);
  color: #333;
}

.sub-nav-btn.active {
  background-color: var(--accent-color);
  color: #fff;
  box-shadow: 0 4px 10px rgba(90, 143, 123, 0.3);
}



.font-controls-row {
    display: flex;
    gap: 5px;
    justify-content: space-between;
}

.font-controls-row button {
    flex: 1;
    padding: 6px 0;
    border: 1px solid #eee;
    background: #f9f9f9;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    color: #555;
}
.font-controls-row button:hover { background: #eee; }

.settings-divider { height: 1px; background: #eee; margin: 10px 0; }

.text-btn {
    width: 100%;
    text-align: left;
    background: transparent;
    border: none;
    padding: 8px;
    cursor: pointer;
    font-size: 0.95rem;
    color: #5b5044;
    border-radius: 6px;
}
.text-btn:hover { background: #f3f4f6; }



/* [v12.0] CSS æœ€çµ‚ä¿®å¾©ï¼šSetting Z-Index & Mobile Header */

/* 1. è¨­å®šé¸å–® (å¼·åˆ¶æœ€é ‚å±¤ï¼Œè§£æ±ºé®æ“‹) */
.settings-menu-popover {
    position: absolute;
    top: 45px;
    right: auto; /* é å·¦å½ˆå‡ºï¼Œé˜²æ­¢æ‰‹æ©Ÿç‰ˆå‡ºç•Œ */
    left: 0;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 10px 50px rgba(0,0,0,0.3); /* æ·±é™°å½± */
    border: 1px solid rgba(0,0,0,0.05);
    width: 200px;
    padding: 12px;
    z-index: 2147483647 !important; /* ğŸ”¥ å®‡å®™æœ€é«˜ï¼Œä¿è­‰å””æœƒè¢«é® */
    color: #555;
}






.page-content { 
  display: none; 
  /* ç¨å¾®èª¿æ•´èƒŒæ™¯ï¼Œé…åˆæ–°é¢¨æ ¼ */
  background: radial-gradient(circle at top, #fdfbf7 0, #fbf8f3 45%, #f3f4f6 100%);
  min-height: 80vh;
}

.page-content.active { 
  display: block; 
}

/* ===== section å€å¡Š (åŠ å…¥ scroll-margin-top) ===== */
.section-box {
padding: 2rem;
border-bottom: 1px solid rgba(225,216,200,0.6);
background-color: rgba(252,250,246,0.88);

/* ğŸ”¥ æ ¸å¿ƒä¿®æ­£ï¼šå‘Šè¨´ç€è¦½å™¨ Scroll åˆ°é€™è£¡æ™‚ï¼Œè¦é ç•™å¹¾å¤šé ‚éƒ¨ç©ºé–“ */
scroll-margin-top: 160px;
}


  .section-box:nth-child(odd) {
    background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(251,246,238,0.9));
  }
  
  .section-box:last-child {
    border-bottom: none;
  }

  .input-group { 
    margin-bottom: 1.25rem; 
  }

  .input-group label { 
    display: block; 
    font-weight: 600; 
    margin-bottom: 0.55rem; 
    font-size: 1.05rem; 
    color: #716659;
  }

  .input-group input[type="text"], 
  .input-group input[type="number"], 
  .input-group textarea, 
  .input-group select {
    width: 100%; 
    padding: 0.75rem 1rem; 
    border: 1px solid var(--border-color); 
    border-radius: var(--radius-md); 
    font-size: 0.96rem; 
    box-sizing: border-box; 
    background-color: #fefcf9; 
    font-family: inherit;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast),
                background-color var(--transition-fast), transform var(--transition-fast);
  }

  .input-group textarea { 
    resize: vertical; 
    min-height: 90px; 
  }

  .input-group input:focus, 
  .input-group textarea:focus, 
  .input-group select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px rgba(90, 143, 123, 0.25), 0 10px 20px rgba(0,0,0,0.08);
    background-color: #ffffff;
    transform: translateY(-1px);
  }

  .two-column-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
  }

  .two-column-grid .input-group {
    margin-bottom: 0; 
  }

  .two-column-grid .input-group textarea {
    min-height: 150px; 
  }

  @media (max-width: 768px) {
    .two-column-grid {
      grid-template-columns: 1fr;
      gap: 1.25rem;
    }
    .two-column-grid .input-group textarea {
      min-height: 120px;
    }
  }

  /* ===== è©•åˆ† layout (ä¿®æ”¹) ===== */
  .score-main-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1.25rem;
  }
  
  .score-main-grid .input-group {
    margin-bottom: 0;
  }

  .score-total-box input[readonly] {
    background-color: #f6f1e7;
    font-weight: bold;
    font-size: 1.1rem;
    text-align: center;
    padding: 0.9rem 1rem;
    letter-spacing: 0.12em;
  }

  /* ===== details / summary ===== */

  details { 
    background: #fdfdfc; 
    border: 1px solid rgba(225,216,200,0.9); 
    border-radius: var(--radius-md); 
    margin-bottom: 1rem;
    box-shadow: 0 8px 18px rgba(0,0,0,0.04);
    overflow: hidden;
  }

  summary { 
    padding: 1rem 1.25rem; 
    font-weight: 500; 
    font-size: 1.2rem; 
    color: var(--title-color); 
    cursor: pointer; 
    list-style: none; 
    display: flex; 
    justify-content:space-between; 
    align-items:center; 
    background: linear-gradient(90deg, rgba(250,247,241,0.95), rgba(239,247,243,0.9));
  }

  summary::-webkit-details-marker { 
    display: none; 
  }

  summary::after { 
    content: 'ï¼‹'; 
    font-size: 1.4rem; 
    transition: transform var(--transition-fast), color var(--transition-fast); 
    color: var(--accent-color); 
  }

  details[open] > summary::after { 
    transform: rotate(45deg); 
    color: #44725f;
  }

  details[open] > summary { 
    border-bottom: 1px solid rgba(225,216,200,0.9); 
    box-shadow: inset 0 -5px 10px rgba(0,0,0,0.03);
  }

  .critique-items-container { 
    padding: 1.25rem; 
    background: #fefcf9;
  }
  
  summary > h2, summary > h3 {
    display: inline;
    margin: 0;
    font-size: inherit;
    color: inherit;
    font-weight: inherit;
    border-bottom: none;
    padding-bottom: 0;
  }

 /* ===== [v10.2-Step1] è©•èª Checkbox (Cozy Touch ç‰ˆ) ===== */

  /* ===== [v10.2-Final] è©•èª Checkbox (åªæ”¹æ ¼ä»”ï¼Œä¸å‹•å…¨ç«™) ===== */

/* 1. å¡ç‰‡æœ¬é«” */
.check-item { 
  border: 1px solid rgba(225,216,200,0.9); /* ç¶­æŒåŸæœ‰é‚Šæ¡†è‰² */
  border-radius: 10px; 
  margin-bottom: 0.8rem; 
  background: #ffffff; 
  box-shadow: 0 2px 5px rgba(0,0,0,0.03); 
  transition: all 0.2s ease;
  cursor: pointer;
  overflow: hidden; /* ç¢ºä¿å…§å®¹å””æœƒçˆ†å‡ºåœ“è§’ */
}

/* Hover æ•ˆæœ */
.check-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(90, 143, 123, 0.1);
  border-color: var(--accent-color);
}

/* é¸ä¸­ç‹€æ…‹ (é…åˆ JS é‚è¼¯) */
/* ç•¶è£¡é¢çš„ checkbox è¢«å‰”é¸æ™‚ï¼Œæ”¹è®Šå¤–æ¡†é¡è‰² */
.check-item:has(input:checked) {
  background-color: #fcfdfc; /* æ¥µæ·¡ç¶ ï¼Œå€åˆ†å·²é¸ */
  border-color: var(--accent-color);
  box-shadow: 0 0 0 1px var(--accent-color) inset; /* å…§ç™¼å…‰é‚Šæ¡† */
}

/* 2. Header ä½ˆå±€ (é—œéµ) */
.check-item-header { 
  display: flex; 
  align-items: center; 
  width: 100%;
  position: relative;
  /* ç§»é™¤ paddingï¼Œæ”¹ç”± label æ’é–‹ */
  padding: 0; 
}

/* 3. Checkbox æœ¬é«” (å°é–é»æ“Š) */
.check-item-header input[type="checkbox"] { 
  position: absolute;
  left: 12px; /* å›ºå®šåœ¨å·¦é‚Š */
  width: 1.2rem; 
  height: 1.2rem; 
  accent-color: var(--accent-color); 
  border-radius: 4px;
  cursor: pointer;
  pointer-events: none; /* ğŸ”¥ æ ¸å¿ƒï¼šè®“é»æ“Šç©¿é€ï¼Œäº¤çµ¦ Parent è™•ç†ï¼Œæ¶ˆé™¤æ†¤æ€’é»æ“Š */
}

/* 4. æ–‡å­—æ¨™ç±¤ (æ’å¤§ç†±å€) */
.check-item-header label { 
  flex: 1; 
  font-size: 1.05rem; 
  font-weight: 500; 
  cursor: pointer;
  padding: 14px 12px 14px 42px; /* ä¸Šå³ä¸‹å·¦ (å·¦é‚Šé ç•™ä½ä¿¾ checkbox) */
  display: block; /* å¡«æ»¿ */
  user-select: none;
  color: #5b5044;
}

/* é¸ä¸­æ™‚æ–‡å­—è®Šè‰² */
.check-item:has(input:checked) label {
  color: #2c4c3f; 
  font-weight: 600;
}

/* 5. ä¸‹æ‹‰æ¨¡çµ„èˆ‡ç·¨è¼¯æ¡† (å¾®èª¿é–“è·) */
.interactive-module { 
  display: none; 
  background-color: #f9f9f9; 
  border-top: 1px dashed rgba(225,216,200,0.8); 
  padding: 12px 16px; 
  margin: 0;
}

.editable-comment { 
  display: none; 
  padding: 0 16px 16px 16px; 
  background-color: transparent;
}

  .check-item.is-problem label { 
    color: var(--problem-color); 
  }

  .check-item.is-excellent label { 
    color: var(--excellent-color); 
  }

  .interactive-module { 
    display: none; 
    background-color: #f7faf7; 
    border: 1px dashed rgba(90,143,123,0.5); 
    border-radius: var(--radius-md); 
    padding: 0.9rem; 
    margin-top: 0.8rem; 
  }

  .interactive-module .module-row { 
    display: flex; 
    align-items: center; 
    gap: 0.7rem; 
    margin-bottom: 0.7rem; 
    flex-wrap: wrap; 
  }
  .interactive-module .module-row:last-child {
    margin-bottom: 0;
  }

  .interactive-module .module-row label { 
    font-weight: normal; 
    margin-bottom: 0; 
    flex-shrink: 0; 
  }

  .interactive-module select, 
  .interactive-module input[type="text"] { 
    flex-grow: 1; 
    padding: 0.5rem 0.8rem; 
    border: 1px solid var(--border-color); 
    border-radius: var(--radius-sm); 
    min-width: 150px; 
    background-color: #ffffff;
  }

  .interactive-module .other-input { 
    display: none; 
    margin-top: 0.3rem; 
  }

  .editable-comment { 
    display: none; 
    margin-top: 0.8rem; 
  }

  .editable-comment textarea { 
    width: 100%; 
    min-height: 120px; 
    padding: 0.75rem; 
    font-size: 0.94rem; 
    line-height: 1.7; 
    border: 1px dashed var(--accent-color); 
    border-radius: var(--radius-md); 
    background: #fcfffd; 
    box-sizing: border-box; 
  }

  /* ===== Output Panel ===== */
  
  .panel { 
    border: 1px solid rgba(225,216,200,0.9); 
    border-radius: 16px; 
    background: #fefdfb; 
    padding: 1.1rem; 
    display: flex; 
    flex-direction: column;
    box-shadow: 0 14px 30px rgba(0,0,0,0.08);
  }

  .panel details { 
    border: none; 
    background: transparent; 
    margin-bottom: 0; 
    box-shadow: none;
  }

  .panel details > summary { 
    padding: 0.5rem 0.5rem 0.2rem; 
    font-size: 1.35rem; 
    background: transparent; 
  }

  .panel details[open] > summary { 
    border-bottom: 1px solid var(--border-color); 
    box-shadow: none; 
  }

  .panel .panel-content-wrapper { 
    padding: 0.9rem 0.15rem 0.3rem 0.15rem; 
  }
  
  .panel h3 { 
    margin: 0; 
  }

  .panel .panel-actions { 
    display:flex; 
    gap:0.5rem; 
    padding:0.3rem 0.3rem 0.7rem; 
    flex-wrap: wrap; 
    justify-content: flex-end;
  }

  .panel textarea { 
    width: 100%; 
    flex: 1 1 auto; 
    min-height: 350px; 
    padding: 1rem; 
    border: 1px solid rgba(225,216,200,0.9); 
    border-radius: 10px; 
    font-size: 0.98rem; 
    line-height: 1.8; 
    resize: vertical; 
    box-sizing:border-box; 
    background: #fffdfa; 
    font-family: inherit;
    transition: box-shadow var(--transition-fast), border-color var(--transition-fast),
                background-color var(--transition-fast);
  }

  .panel textarea:focus {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px rgba(90,143,123,0.25);
    background-color: #ffffff;
  }

  @media (max-width: 980px) { 
    header {
      flex-direction: column;
      align-items: flex-start;
    }
  }

  @media (max-width: 600px) {
    html { font-size: 15px; }
    body { background-color: var(--secondary-bg); }
    .main-container { 
      margin: 0; 
      box-shadow: none; 
      border-radius: 0; 
      border: none; 
    }
    .section-box, #paired-output-section { 
      padding: 1.25rem 1rem; 
    }
    h1 { font-size: 1.9rem; }
    header { padding: 1rem 1.25rem; }
  }

  /* ===== æŒ‰éˆ•é€šç”¨æ¨£å¼ ===== */

  .action-btn, .secondary-btn, .danger-btn, .light-btn, .btn { 
    border-radius: 999px; 
    border: none;
    cursor: pointer;
    font-family: inherit;
    font-size: 0.98rem;
    padding: 0.7rem 1.5rem;
    transition: background-color var(--transition-fast), box-shadow var(--transition-fast),
                transform var(--transition-fast), opacity var(--transition-fast);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    white-space: nowrap;
  }

  .action-btn { 
    color: white; 
    background: linear-gradient(135deg, #5A8F7B, #78a693); 
    box-shadow: 0 10px 20px rgba(41,81,64,0.35);
  }

  .action-btn:hover { 
    opacity: 0.95; 
    transform: translateY(-1px);
    box-shadow: 0 14px 26px rgba(41,81,64,0.38);
  }

  .action-btn:active {
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 5px 12px rgba(41,81,64,0.45);
  }

  .action-btn.clear-all { 
    background: linear-gradient(130deg, #c86a5a, #de8373); 
    box-shadow: 0 10px 20px rgba(133,54,41,0.35);
  }

  .action-btn.copied { 
    background: linear-gradient(135deg, var(--copy-success-bg), #92c3aa); 
  }

  .secondary-btn { 
    background: linear-gradient(135deg, var(--btn-brown-bg), var(--btn-brown-hover)); 
    color:#fff; 
    box-shadow: 0 8px 16px rgba(87,69,50,0.35);
  }

  .secondary-btn:hover { 
    opacity: 0.95; 
    transform: translateY(-1px); 
    box-shadow: 0 12px 22px rgba(87,69,50,0.42);
  }

  .danger-btn { 
    background: linear-gradient(135deg, #c86a5a, #de8b7c); 
    color:#fff; 
    padding:0.45rem 0.9rem; 
    box-shadow: 0 7px 15px rgba(133,54,41,0.4);
  }

  .danger-btn:hover { 
    opacity: 0.97; 
    transform: translateY(-1px);
  }

  .light-btn { 
    background: linear-gradient(135deg, #cfe3d9, #9fbfaf); 
    color:#305244; 
    padding:0.55rem 1.1rem; 
    box-shadow: 0 7px 14px rgba(60,90,80,0.28);
  }

  .light-btn.brown { 
    background: linear-gradient(135deg, #dac5a8, #b29372); 
    color:#3f3327; 
  }

  .light-btn:hover { 
    opacity:0.96; 
    transform: translateY(-1px); 
  }

  .btn-primary { 
    background: linear-gradient(135deg, #5A8F7B, #78a693); 
    color:#fff;
  }

  .btn-secondary { 
    background: linear-gradient(135deg, #a18b73, #8d775f); 
    color:#fff;
  }

  .btn-danger { 
    background: linear-gradient(135deg, #c86a5a, #de8475); 
    color:#fff;
  }

  /* ===== Overview / ç©ºç‹€æ…‹ ===== */

  .overview-container { 
    padding: 2rem; 
  }

  .btn-group { 
    display: flex; 
    gap: 0.7rem; 
    flex-wrap: wrap; 
  }
  
  .overview-panel { 
    display: grid; 
    gap: 1rem; 
  }

  .overview-item { 
    border:1px solid var(--border-color); 
    border-radius:var(--radius-md); 
    overflow:hidden; 
    box-shadow: 0 9px 20px rgba(0,0,0,0.06);
    background: #fefbf7;
  }

  .overview-item summary { 
    font-weight: 500; 
    font-size: 1.02rem; 
  }

  .overview-item.is-problem summary { 
    color: var(--problem-color); 
  }

  .overview-item.is-excellent summary { 
    color: var(--excellent-color); 
  }

  .badge { 
    font-size:0.72rem; 
    padding:0.18rem 0.6rem; 
    border-radius:999px; 
    background:var(--nav-bg); 
    color:var(--text-color); 
    margin-left: 0.35rem;
  }

  .overview-body { 
    padding: 1.25rem; 
    background-color: #fdfcf9; 
  }

  .overview-row { 
    display:grid; 
    gap:0.5rem; 
    margin-bottom:0.75rem; 
  }

  .overview-row label { 
    font-weight:normal; 
  }

  .overview-row input[type="text"], 
  .overview-row textarea,
  .overview-row select { 
    width:100%; 
    padding:0.6rem 0.8rem; 
    border:1px solid var(--border-color); 
    border-radius:var(--radius-sm); 
    font-family: inherit; 
    background-color: #ffffff;
    font-size:0.95rem;
  }

  .overview-row textarea { 
    min-height:110px; 
    font-size:0.95rem; 
    line-height:1.6; 
    box-sizing:border-box; 
    resize:vertical; 
  }

  #add-critique-section { 
    border: 2px dashed var(--accent-color); 
    background: var(--dashed-box-bg); 
    box-shadow: 0 8px 18px rgba(0,0,0,0.04);
  }

  #add-critique-section summary { 
    font-size: 1.25rem; 
    font-weight: 500; 
  }

  .add-critique-form { 
    padding: 1.25rem; 
    display: grid; 
    gap: 1rem; 
  }

  .add-critique-grid { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); 
    gap: 1rem; 
  }

  .radio-group { 
    display: flex; 
    gap: 1.25rem; 
    align-items: center; 
  }

  .radio-group label { 
    font-weight: normal; 
    margin-bottom: 0; 
  }

  .radio-group input { 
    margin-right: 0.3rem; 
    accent-color: var(--accent-color); 
  }

  .typo-saved-box { 
    border:1px solid var(--border-color); 
    border-radius:var(--radius-md); 
    padding:1.25rem; 
    background:#f7fafc; 
    margin-top:1rem; 
    box-shadow: 0 8px 18px rgba(0,0,0,0.04);
  }

  .typo-saved-box h3 { 
    margin: 0 0 1rem 0; 
    font-size: 1.2rem; 
  }

  .typo-saved-list { 
    list-style:none; 
    padding:0; 
    margin:0; 
    max-height:220px; 
    overflow:auto; 
  }

  .typo-saved-list li { 
    display:flex; 
    align-items:center; 
    gap:0.5rem; 
    padding:0.45rem 0.7rem; 
    border:1px solid #e7edf5; 
    background:#ffffff; 
    border-radius:6px; 
    margin-bottom:0.45rem; 
  }

  .typo-saved-list .word { 
    flex:1; 
  }

  .io-box {
    border: 2px dashed var(--accent-color);
    background: var(--dashed-box-bg);
    padding: 1.25rem;
    margin-top: 1.25rem;
    border-radius: var(--radius-md);
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .io-box-title {
    font-size: 1.1rem;
    color: var(--title-color);
    font-weight: 500;
    margin: 0 0 0.3rem 0;
  }

  .io-details {
      border: 2px dashed var(--accent-color);
      background: var(--dashed-box-bg);
      border-radius: var(--radius-md);
      margin-top: 1.25rem;
      box-shadow: 0 6px 14px rgba(0,0,0,0.06);
  }

  .io-details > summary {
      font-size: 1.1rem;
      color: var(--title-color);
      font-weight: 500;
  }

  .io-details-content {
      padding: 0 1.25rem 1.25rem 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
  }

  /* ===== Modal ===== */

  .modal-backdrop {
    position: fixed; 
    inset: 0; 
    background: var(--modal-bg); 
    display: none; 
    align-items: center; 
    justify-content: center; 
    z-index: 9999;
    backdrop-filter: blur(3px);
  }

  .modal-backdrop.active { 
    display: flex; 
  }

  .modal-card {
    width: min(92vw, 420px); 
    background: var(--modal-card-bg); 
    border-radius: 18px; 
    box-shadow: 0 24px 55px rgba(0,0,0,0.30);
    padding: 1.25rem 1.5rem 1.2rem; 
    display: flex; 
    flex-direction: column; 
    gap: 1rem;
    border: 1px solid rgba(255,255,255,0.85);
  }

  .modal-title { 
    font-weight: 600; 
    font-size: 1.15rem; 
    color: var(--title-color); 
  }

  .modal-actions { 
    display: flex; 
    gap: 0.7rem; 
    justify-content: flex-end; 
    flex-wrap: wrap; 
  }

  .btn { 
    padding: 0.55rem 1.3rem; 
  }

  .empty-state-message {
    padding: 1.2rem;
    text-align: center;
    background: var(--empty-state-bg);
    border-radius: var(--radius-md);
    color: var(--empty-state-text);
    margin-top: 1rem;
    border: 1px dashed var(--border-color);
    font-size: 0.92rem;
  }
  
  
  /* ===== å­¸ç”Ÿç¸½è¦½ ===== */

  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  #overview-class-display {
    font-size: 1.25rem;
    color: var(--title-color);
    margin: 0;
  }

  #student-overview-table-wrapper {
    overflow: auto;
    max-height: 70vh;
    margin-top: 1.25rem;
    background-color: #fdfbf8;
    border-radius: 12px;
    border: 1px solid rgba(225,216,200,0.9);
    box-shadow: 0 10px 24px rgba(0,0,0,0.06);
  }

  #student-overview-table {
    width: 100%;
    min-width: 1200px;
     /* â–¼ é‡é»ï¼šä¸€å®šè¦ç”¨ separate åŒåŸ‹ spacing 0 */
  border-collapse: separate; 
  border-spacing: 0;
  font-size: 0.85em;
}
/* å‡çµæ•´å€‹è¡¨é ­ */
#student-overview-table thead th {
  position: sticky;
  top: 0;
  z-index: 10; /* æ¯”å…§å®¹å±¤ç´šé«˜ */
  background: linear-gradient(135deg, #f1ece4, #e8f0ea);
  border-bottom: 1px solid rgba(225,216,200,0.9);
}

/* â–¼ ç‰¹åˆ¥è™•ç†ï¼šå·¦ä¸Šè§’å…©æ ¼ (å­¸è™Ÿã€å§“åå˜…è¡¨é ­) */
/* ä½¢å“‹åˆè¦ sticky topï¼Œåˆè¦ sticky leftï¼Œæ‰€ä»¥ z-index è¦æœ€é«˜ */
#student-overview-table thead th:nth-child(1),
#student-overview-table thead th:nth-child(2) {
  z-index: 20; 
}

  

  #student-overview-table th, 
  #student-overview-table td {
    border: 1px solid rgba(225,216,200,0.9);
    padding: 0.55rem 0.75rem;
    text-align: center;
    vertical-align: top;
  }

  #student-overview-table th {
    background: linear-gradient(135deg, #f1ece4, #e8f0ea);
    color: var(--title-color);
    position: sticky;
    top: 0;
    z-index: 3;
  }
  
 /* æµç•ªæˆ–è€…åŠ å…¥å‘¢æ®µ */
#student-overview-table th:nth-child(1),
#student-overview-table td:nth-child(1) {
  position: sticky;
  left: 0;
  z-index: 5;
  width: 80px;
  min-width: 80px;
  /* â–¼ é‡é»ï¼šè¦ä¿¾å€‹å¯¦è‰²èƒŒæ™¯ä½¢ï¼Œå¦‚æœå””ä¿‚æ²å‹•å—°é™£æœƒé€åº• */
  background-color: #fdfbf8; 
  border-right: 1px solid rgba(225,216,200,0.9);
}

  /* æµç•ªæˆ–è€…åŠ å…¥å‘¢æ®µ */
#student-overview-table th:nth-child(2),
#student-overview-table td:nth-child(2) {
  position: sticky;
  /* â–¼ é‡é»ï¼šç·Šæ¥ä½ç¬¬ä¸€æ¬„å˜…é—Šåº¦ */
  left: 80px; 
  z-index: 5;
  width: 90px;
  min-width: 90px;
  background-color: #fdfbf8;
  /* â–¼ å»ºè­°ï¼šåŠ æ¢ç²—å°‘å°‘å˜…ç·šï¼Œåˆ†éš”å‡çµå€åŒå…§å®¹å€ */
  border-right: 2px solid var(--accent-color); 
}

  #student-overview-table td:nth-child(1),
  #student-overview-table td:nth-child(2) {
    background-color: #fdfbf8;
  }
  
  #student-overview-table .row-missing td:nth-child(1),
  #student-overview-table .row-missing td:nth-child(2) {
    background-color: var(--danger-bg-soft);
  }

  #student-overview-table td input[type="number"] {
    width: 60px;
    padding: 0.35rem 0.3rem;
    text-align: center;
    border: 1px solid transparent;
    border-radius: 4px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    transition: background-color var(--transition-fast), border-color var(--transition-fast),
                box-shadow var(--transition-fast);
  }

  #student-overview-table td input[type="number"]:focus {
    outline: none;
    background-color: #fff;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px rgba(90, 143, 123, 0.2);
  }

  #student-overview-table .total-score-cell {
      font-weight: bold;
      background-color: #f6f1e7;
  }

  #student-overview-table th:nth-child(3), #student-overview-table td:nth-child(3),
  #student-overview-table th:nth-child(4), #student-overview-table td:nth-child(4),
  #student-overview-table th:nth-child(5), #student-overview-table td:nth-child(5),
  #student-overview-table th:nth-child(6), #student-overview-table td:nth-child(6),
  #student-overview-table th:nth-child(7), #student-overview-table td:nth-child(7) {
    width: 75px;
    min-width: 75px;
  }

  #student-overview-table td:nth-child(9),
  #student-overview-table td:nth-child(10) {
    text-align: left;
    min-width: 350px;
    max-width: 500px;
  }

  /* 1. é€²åº¦æ‰‹å¸³ (Page 4) è¡¨æ ¼ä¿®å¾© */
#student-overview-table textarea {
    min-height: 120px !important; /* å¼·åˆ¶é«˜åº¦ï¼Œé˜²æ­¢å¡Œé™·çœ‹ä¸è¦‹å­— */
    width: 100% !important;
    padding: 8px !important;
    line-height: 1.5 !important;
    background: transparent;
    border: 1px dashed transparent;
    transition: all 0.2s;
}
#student-overview-table textarea:focus,
#student-overview-table textarea:hover {
    border-color: #ddd;
    background: #fff;
}

  #student-overview-table textarea:focus {
    outline: none;
    background-color: #fff;
    box-shadow: 0 0 0 2px var(--accent-color) inset;
    border-radius: 4px;
  }

  .row-missing {
    background-color: var(--danger-bg-soft);
  }

  .row-missing .total-score-cell {
    border-color: var(--danger-border-soft);
    color: var(--problem-color);
    font-weight: bold;
  }


  /* æ‰‹æ©Ÿç‰ˆç‰¹åˆ¥åŠ é—Š */
@media (max-width: 768px) {
    #student-overview-table textarea {
        min-height: 150px !important;
        border: 1px solid #eee !important; /* æ‰‹æ©Ÿç‰ˆçµ¦å€‹æ¡†ï¼Œæ¯”è¼ƒæ¸…æ¥š */
        background: #fafafa !important;
    }
    /* ä¿®æ­£æ‰‹æ©Ÿç‰ˆè¡¨æ ¼å¡ç‰‡å…§éƒ¨æ’ç‰ˆ */
    #student-overview-table td:nth-of-type(9) {
        display: block !important; /* è©•èªæ¬„ç¨ç«‹ä¸€è¡Œ */
        width: 100% !important;
    }
}

/* 4. Pop-up æŒ‰éˆ•å¾©åŸ (æ—¢ç„¶å‚ç›´å””å¾—ï¼Œå°±æ”¹å›æ°´å¹³ä½†å­—é«”æ›´ç´°) */
@media (max-width: 600px) {
    .pop-footer {
        flex-direction: row; /* è®Šå›æ©«æ’ */
        gap: 8px;
    }
    .pop-btn {
        padding: 8px 4px !important; /* æ¸›å°‘ Padding */
        font-size: 0.85rem !important; /* ç¸®ç´°å­—é«” */
        flex: 1; /* å¹³å‡åˆ†é… */
        white-space: nowrap !important; /* ä¸æ›è¡Œ */
    }
}
  /* ===== åˆ†é¡æ‘ºç–Š ===== */

  .category-group {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    margin-bottom: 1.25rem;
    background-color: #fdfcf9;
    box-shadow: 0 10px 22px rgba(0,0,0,0.05);
  }

  .category-group > summary {
    background: linear-gradient(135deg, #f4ede2, #ecf3ef);
    padding: 0.85rem 1.25rem;
    border-radius: var(--radius-md) var(--radius-md) 0 0;
  }

  .category-group > summary > h3 {
    font-size: 1.35rem;
  }

  .category-group[open] > summary {
    border-bottom: 1px solid var(--border-color);
  }

  .category-content {
    padding: 1.25rem;
  }

  .category-content .overview-item {
    margin-bottom: 1rem;
  }

  .category-content .overview-item:last-child {
    margin-bottom: 0;
  }

  /* ===== åˆ†æ ===== */

  .analysis-grid {
    display: grid;
    grid-template-columns: minmax(0, 2fr) minmax(0, 3fr);
    gap: 1.5rem;
    align-items: flex-start;
  }

  @media (max-width: 900px) {
    .analysis-grid {
      grid-template-columns: 1fr;
    }
  }

  .analysis-card {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: 1.1rem 1.25rem 1.2rem;
    background-color: #fdfcf9;
    box-shadow: 0 10px 22px rgba(0,0,0,0.05);
  }

  .analysis-card h3 {
    margin-top: 0;
    margin-bottom: 0.75rem;
  }

  .analysis-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
  }

  .analysis-table th,
  .analysis-table td {
    border: 1px solid var(--border-color);
    padding: 0.4rem 0.6rem;
    text-align: left;
  }

  .analysis-table th {
    background-color: #f1ece4;
  }

  .checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem 1.5rem;
    background-color: #f7fafc;
    padding: 1rem;
    border-radius: var(--radius-md);
    border: 1px solid var(--border-color);
  }

  .checkbox-group label {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    cursor: pointer;
    font-size: 1rem;
  }
  
  /* ===== AI é é¢ ===== */
  .ai-page-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    align-items: flex-start;
  }

  .ai-page-grid > div {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  @media (max-width: 900px) {
    .ai-page-grid {
      grid-template-columns: 1fr;
    }
  }

  .ai-feedback-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
    flex-wrap: wrap;
    gap: 0.5rem 1rem;
  }

  .ai-feedback-section-header h3 {
    margin: 0;
    font-size: 1.3rem;
  }

  .ai-feedback-section-header .header-tag {
    font-size: 0.8rem;
    padding: 0.2rem 0.6rem;
    border-radius: 99px;
    background-color: var(--accent-color-soft);
    color: var(--accent-color);
    font-weight: bold;
  }

  .ai-feedback-section-header .header-note {
    font-size: 0.9rem;
    color: #888;
  }

  /* ===== æ–°å¢ï¼šæ‰¹æ”¹é ä½ˆå±€èˆ‡æ¨£å¼èª¿æ•´ ===== */
  .grading-page-grid {
    display: block;
    padding: 0;
  }
  .grading-page-grid .section-box {
      padding: 1.5rem;
      margin: 0;
      border-bottom: 1px solid rgba(225,216,200,0.6);
  }
  .grading-page-grid .panel {
      padding: 1rem;
  }
  .grading-page-grid .panel textarea {
      min-height: 250px;
  }

  #checklist-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.25rem;
    margin-top: 1rem;
  }

  .sub-section-card {
    background: #fdfaf5;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    margin-top: 1.5rem;
    box-shadow: 0 6px 15px rgba(0,0,0,0.04);
    overflow: hidden;
  }
  .sub-section-card > summary {
    background: linear-gradient(135deg, #f7f2ea, #f3f7f5);
    border-bottom: 1px solid transparent;
  }
  details[open].sub-section-card > summary {
    border-bottom: 1px solid var(--border-color);
  }
  .sub-section-card-content {
    padding: 1.25rem;
  }

  @media (max-width: 900px) {
    #checklist-container {
        grid-template-columns: 1fr;
    }
  }
  /* --- æ–‡é’é¢¨é€²åº¦å„€è¡¨æ¿ --- */
.literary-progress-box {
  background-color: #fdfcf8;
  border: 1px solid rgba(225, 216, 200, 0.8);
  border-radius: 12px;
  padding: 1.2rem 1.5rem;
  margin-bottom: 1.5rem;
  position: relative;
  box-shadow: 0 4px 12px rgba(0,0,0,0.03);
  display: none; /* é è¨­éš±è—ï¼Œæœ‰æ•¸æ“šæ‰é¡¯ç¤º */
}

.literary-progress-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-bottom: 0.8rem;
  color: var(--text-color);
}

.progress-message {
  font-family: 'LXGW WenKai TC', serif;
  font-size: 1.1rem;
  color: var(--title-color);
}

.progress-stats {
  font-size: 0.95rem;
  color: #8c867a;
  letter-spacing: 0.05em;
}

/* é€²åº¦æ¢èƒŒæ™¯ */
.progress-track {
  width: 100%;
  height: 6px;
  background-color: #eee9e0;
  border-radius: 99px;
  overflow: hidden;
}

/* é€²åº¦æ¢æœ¬é«” */
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #93b8a5, var(--accent-color));
  width: 0%;
  border-radius: 99px;
  transition: width 0.8s cubic-bezier(0.22, 1, 0.36, 1);
}

/* å®Œæˆæ™‚çš„ç‰¹æ•ˆ */
.literary-progress-box.finished {
  background: linear-gradient(135deg, #fdfbf7, #f2f7f4);
  border-color: #d1e2d9;
}
.literary-progress-box.finished .progress-message {
  color: var(--excellent-color);
}

  /* ===== æ–°å¢ï¼šå³å´æ‡¸æµ®å°è¦½åˆ— ===== */
  /* ===== ä¿®æ”¹å¾Œï¼šå³å´æ‡¸æµ®å°è¦½åˆ— (Scrollæ‰é¡¯ç¤ºç‰ˆ) ===== */
#floating-nav {
  position: fixed;
  top: 50%;
  right: 20px;
  transform: translateY(-50%) translateX(30px); /* é è¨­å‘å³éš±è—å°‘å°‘ */
  z-index: 1050;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background-color: rgba(255, 255, 255, 0.75); /* ç¨å¾®å¯¦è‰²å°‘å°‘ï¼Œå› ç‚ºæœƒæ¶ˆå¤± */
  padding: 12px;
  border-radius: 99px;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05);
  
  /* é—œéµï¼šé è¨­å…¨é€æ˜ï¼Œä¸”ä¸å¯é»æ“Š */
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

/* é€™æ˜¯ç”± showPage() æ§åˆ¶çš„ classï¼Œä»£è¡¨ã€Œç¾åœ¨æ˜¯æ‰¹æ”¹é ã€ */
#floating-nav.visible {
  /* å³ä½¿åœ¨æ‰¹æ”¹é ï¼Œé è¨­ä¹Ÿæ˜¯éš±è—ï¼Œç­‰å¾… scroll äº‹ä»¶è§¸ç™¼é¡¯ç¤º */
  opacity: 0;
  pointer-events: none;
}

/* é€™æ˜¯æ–°å¢çš„ç‹€æ…‹ï¼šç•¶æ­£åœ¨ Scroll æˆ–æ»‘é¼ æŒ‡ä½æ™‚ */
#floating-nav.visible.is-scrolling,
#floating-nav.visible:hover {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(-50%) translateX(0);
}

.floating-nav-btn {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background-color: var(--accent-color-soft);
  color: var(--accent-color);
  display: flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  font-size: 1.5rem;
  transition: all var(--transition-normal);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  position: relative;
}

.floating-nav-btn:hover {
  background-color: var(--accent-color);
  color: white;
  transform: scale(1.1);
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}

.floating-nav-btn.active {
  background-color: var(--accent-color);
  color: white;
  box-shadow: 0 0 0 3px var(--secondary-bg), 0 0 0 5px var(--accent-color);
}

/* Tooltip æç¤ºæ–‡å­— */
.floating-nav-btn::before {
  content: attr(data-tooltip);
  position: absolute;
  right: 120%;
  top: 50%;
  transform: translateY(-50%);
  background-color: var(--text-color);
  color: white;
  padding: 5px 10px;
  border-radius: var(--radius-sm);
  font-size: 0.85rem;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition-fast);
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.floating-nav-btn:hover::before {
  opacity: 1;
  transition-delay: 0.3s;
}

/* æ‰‹æ©ŸéŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  #floating-nav {
    top: auto;
    bottom: 25px; /* æ¨é«˜å°‘å°‘ */
    left: 50%;
    right: auto;
    /* æ‰‹æ©Ÿç‰ˆé è¨­å‘ä¸‹éš±è— */
    transform: translateX(-50%) translateY(30px); 
    flex-direction: row;
    padding: 8px 15px; /* åŠ é—Š padding å®¹æ˜“æŒ‰ */
    width: auto;
    max-width: 90vw;
  }
  
  #floating-nav.visible.is-scrolling {
    transform: translateX(-50%) translateY(0);
  }

  .floating-nav-btn {
    width: 44px;
    height: 44px;
    font-size: 1.3rem;
  }
  .floating-nav-btn::before {
    right: 50%;
    top: auto;
    bottom: 120%;
    transform: translateX(50%);
  }
}

  /* ===== åå¸é€šçŸ¥ (Toast Notification) æ¨£å¼ ===== */
  #toast-container {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 99999;
      display: flex;
      flex-direction: column;
      gap: 10px;
      pointer-events: none;
  }

  .toast-notification {
      background-color: white;
      color: var(--text-color);
      padding: 12px 20px;
      border-radius: 50px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      border: 1px solid var(--border-color);
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 10px;
      pointer-events: auto;
      opacity: 0;
      transform: translateY(-20px);
      animation: toastSlideIn 0.4s forwards;
      max-width: 90vw;
      white-space: nowrap;
  }

  .toast-notification.success { border-left: 5px solid var(--excellent-color); }
  .toast-notification.warning { border-left: 5px solid #e6a23c; }
  .toast-notification.error { border-left: 5px solid var(--problem-color); }
  .toast-notification.info { border-left: 5px solid var(--accent-color); }

  @keyframes toastSlideIn {
      to { opacity: 1; transform: translateY(0); }
  }
  @keyframes toastFadeOut {
      to { opacity: 0; transform: translateY(-20px); }
  }
/* === æ‰‹æ©Ÿç‰ˆé˜²æ­¢è‡ªå‹•æ”¾å¤§ä¿®æ­£ === */
@media screen and (max-width: 768px) {
  /* å¼·åˆ¶æ‰‹æ©Ÿç‰ˆè¼¸å…¥æ¡†å­—é«”è‡³å°‘ 16pxï¼Œé˜²æ­¢ iOS è‡ªå‹•æ”¾å¤§ */
  input[type="text"], 
  input[type="number"], 
  textarea, 
  select,
  .pop-input,
  .input-group input,
  .input-group textarea,
  .input-group select {
    font-size: 16px !important; 
  }
}
/* === æ‰‹æ©Ÿç‰ˆè¡¨æ ¼è®Šå¡ç‰‡ (çµ‚æ¥µé˜²çˆ†ç‰ˆ) === */
@media screen and (max-width: 768px) {
  
  /* 1. é—œéµä¿®æ­£ï¼šè§£é™¤åŸæœ¬è¡¨æ ¼çš„ 1200px é—Šåº¦é™åˆ¶ */
  #student-overview-table-wrapper {
    width: 100% !important;
    overflow-x: hidden !important; /* ç¦æ­¢å·¦å³æ²å‹• */
    padding: 0 !important;
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
  }

  #student-overview-table {
    min-width: 0 !important; /* æ®ºæ­» 1200px é™åˆ¶ */
    width: 100% !important;
    display: block !important;
  }

  /* 2. éš±è—è¡¨é ­ */
  #student-overview-table thead {
    display: none !important;
  }

  /* 3. è¡¨æ ¼çµæ§‹å€å¡ŠåŒ– */
  #student-overview-table tbody, 
  #student-overview-table tr, 
  #student-overview-table td {
    display: block !important;
    width: 100% !important;
    box-sizing: border-box !important;
    max-width: 100vw !important; /* ç¢ºä¿ä¸è¶…éè¢å¹•é—Šåº¦ */
  }

  /* 4. å¡ç‰‡æ¨£å¼ */
  #student-overview-table tr {
    margin-bottom: 20px;
    background-color: #ffffff !important;
    border: 2px solid #5A8F7B !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1) !important;
    padding: 15px !important;
  }

  /* 5. æ¯ä¸€è¡Œå…§å®¹ (td) è¨­å®š */
  #student-overview-table td {
    display: flex !important;
    justify-content: space-between;
    align-items: center;
    border: none !important;
    border-bottom: 1px dashed #e0e0e0 !important;
    padding: 12px 0 !important;
    text-align: right !important;
    min-height: 45px;
    
    /* è§£é™¤é—Šåº¦é™åˆ¶ */
    min-width: 0 !important; 
    max-width: 100% !important;
    
    /* æ¸…é™¤å‡çµçª—æ ¼è¨­å®š */
    position: static !important;
    background: transparent !important;
    z-index: auto !important;
    left: auto !important;
    top: auto !important;
  }

  #student-overview-table td:last-child {
    border-bottom: none !important;
  }

  /* 6. å¼·åˆ¶é¡¯ç¤ºæ–‡å­—é¡è‰² */
  #student-overview-table td {
    color: #333333 !important;
    font-size: 1rem !important;
    word-break: break-word; /* é˜²æ­¢é•·æ–‡å­—æ’çˆ† */
  }

  #student-overview-table td a {
    color: #2563eb !important;
    text-decoration: underline !important;
    font-weight: bold;
    display: inline-block;
  }

  /* 7. è¼¸å…¥æ¡†é¡¯å½¢è¨­å®š */
  #student-overview-table input[type="number"] {
    display: inline-block !important;
    width: 80px !important;
    height: 35px !important;
    background-color: #f0f0f0 !important;
    border: 1px solid #999 !important;
    border-radius: 6px !important;
    text-align: center !important;
    color: #000 !important;
    font-weight: bold !important;
    font-size: 16px !important;
    opacity: 1 !important;
  }

  /* 8. åŠ å…¥æ¬„ä½æ¨™ç±¤ */
  #student-overview-table td::before {
    content: attr(data-label-fix);
    font-weight: bold;
    color: #5A8F7B;
    text-align: left;
    flex-shrink: 0;
    margin-right: 10px;
  }

  #student-overview-table td:nth-of-type(1)::before { content: "å­¸è™Ÿ"; }
  #student-overview-table td:nth-of-type(2)::before { content: "å§“å"; }
  #student-overview-table td:nth-of-type(3)::before { content: "å…§å®¹ (40%)"; }
  #student-overview-table td:nth-of-type(4)::before { content: "è¡¨é” (30%)"; }
  #student-overview-table td:nth-of-type(5)::before { content: "çµæ§‹ (20%)"; }
  #student-overview-table td:nth-of-type(6)::before { content: "æ¨™é» (10%)"; }
  #student-overview-table td:nth-of-type(7)::before { content: "éŒ¯åˆ¥å­—"; }
  #student-overview-table td:nth-of-type(8)::before { content: "ç¸½åˆ†"; color: #d48806; }
  #student-overview-table td:nth-of-type(9)::before { content: "å­¸ç”Ÿè©•èª"; }

  /* 9. è©•èªæ¬„ä½ (Textarea) ç‰¹åˆ¥è™•ç† */
  #student-overview-table td:nth-of-type(9) {
    flex-direction: column;
    align-items: flex-start;
  }
  #student-overview-table td:nth-of-type(9)::before {
    margin-bottom: 8px;
  }
 

  /* 10. éš±è—ä¸éœ€è¦çš„æ¬„ä½ */
  #student-overview-table td:nth-of-type(10) { display: none !important; }

  /* 11. ç©ºç‹€æ…‹ä¿®æ­£ */
  .empty-state-message {
    text-align: center !important;
    color: #666 !important;
    display: block !important;
    white-space: normal !important;
  }
}




/* === Dashboard Grid & Card Styles (New) === */

/* 1. ç¶²æ ¼å®¹å™¨ï¼šè‡ªå‹•é©æ‡‰é—Šåº¦ï¼Œé›»è…¦ç‰ˆä¸€è¡Œ3-4å€‹ï¼Œæ‰‹æ©Ÿä¸€è¡Œ1å€‹ */
.task-list-container, .class-group-content {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.2rem;
    padding: 0.5rem 0;
}

/* 2. ç­ç´šå¡ç‰‡ (é‡è£½ï¼šä»¿ Cozy Folder é¢¨æ ¼) */
.task-item {
    background: #ffffff !important;
    border: 1px solid rgba(0,0,0,0.06) !important; /* æ¥µæ·¡é‚Šæ¡† */
    border-radius: 16px !important;
    box-shadow: 0 4px 20px rgba(0,0,0,0.03) !important; /* ç©ºæ°£æ„Ÿé™°å½± */
    padding: 1.5rem !important;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    position: relative;
    
    /* ç§»é™¤èˆŠæœ‰çš„é ‚éƒ¨/å·¦å´ç²—ç·š */
    border-top: none !important;
    border-left: none !important;
    
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    min-height: 160px;
}

/* æ‡¸æµ®æ•ˆæœ (æµ®èµ·) */
.task-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.08) !important;
    border-color: rgba(0,0,0,0.1) !important;
}

/* 3. å¡ç‰‡å…§çš„è£é£¾æ¨™ç±¤ (Tag) */
.class-tag {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    margin-bottom: 8px;
}

/* 4. å¡ç‰‡æ¨™é¡Œ */
.class-title {
    font-size: 1.6rem;
    font-weight: 700;
    color: #4a4a4a;
    line-height: 1.2;
    margin-bottom: auto; /* æ¨é–‹åº•éƒ¨ */
}

/* 5. åº•éƒ¨å·¥å…·åˆ— */
.class-footer {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #f0f0f0;
}

.recent-proj-pill {
    font-size: 0.8rem;
    color: #666;
    background: rgba(255,255,255,0.6);
    padding: 4px 8px;
    border-radius: 6px;
    margin-top: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* 2. ç§»é™¤å¡ç‰‡å…§å¤šé¤˜çš„ç¶ è‰²è£é£¾ç·š */
.task-item::before {
    display: none !important;
    content: none !important;
}

.task-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 20px rgba(90, 143, 123, 0.15);
    border-color: var(--accent-color);
}

/* 3. å¡ç‰‡å…§å®¹æ’ç‰ˆ */
.task-meta {
    margin-top: 0.8rem;
    margin-bottom: 1rem;
}

.task-class-badge {
    display: inline-block;
    font-size: 0.75rem; 
    background: #f4ede2; 
    color: #8d775f; 
    padding: 3px 8px; 
    border-radius: 6px; 
    font-weight: bold;
    margin-bottom: 0.5rem;
    letter-spacing: 0.05em;
}

.task-topic { 
    display: block;
    font-weight: 600; 
    color: var(--title-color); 
    font-size: 1.15rem; 
    line-height: 1.4;
    
    /* é™åˆ¶æ¨™é¡Œæœ€å¤šé¡¯ç¤ºå…©è¡Œï¼Œå¤ªå¤šå­—å‡º... */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* 4. é€²åº¦æ¢èˆ‡æ—¥æœŸ (åº•éƒ¨) */
.task-footer {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 1rem;
}

.task-progress { 
    flex: 1; 
    margin: 0; /* é‡ç½®èˆŠè¨­å®š */
    display: flex; 
    flex-direction: column; 
    gap: 6px; 
}

.task-progress-bar-bg { height: 5px; background: #eee; border-radius: 99px; width: 100%; }
.task-progress-bar-fill { height: 100%; background: var(--accent-color); border-radius: 99px; }

.task-date { 
    font-size: 0.75rem; 
    color: #aaa; 
    white-space: nowrap; 
}

/* === Kebab Menu (ä¸‰é»é¸å–®) === */
.kebab-menu-container {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 20;
}

.kebab-btn {
    background: transparent;
    border: none;
    font-size: 1.4rem;
    color: #ccc;
    cursor: pointer;
    padding: 0 8px;
    line-height: 1;
    border-radius: 4px;
    transition: color 0.2s;
}

.task-item:hover .kebab-btn {
    color: #999; /* æ»‘é¼ æŒ‡ä½å¡ç‰‡æ™‚ï¼Œä¸‰é»è®Šæ·±è‰² */
}
.kebab-btn:hover {
    color: var(--accent-color) !important;
    background-color: rgba(0,0,0,0.03);
}

/* é¸å–®å½ˆå‡ºå±¤ */
.kebab-dropdown {
    display: none; /* é è¨­éš±è— */
    position: absolute;
    top: 100%;
    right: 0;
    width: 140px;
    background: white;
    border: 1px solid #e1d8c8;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow: hidden;
    animation: fadeInMenu 0.15s ease-out;
}

.kebab-dropdown.show {
    display: block;
}

.kebab-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 10px 12px;
    border: none;
    background: transparent;
    text-align: left;
    font-size: 0.9rem;
    color: #555;
    cursor: pointer;
    font-family: inherit;
    transition: background 0.1s;
}

.kebab-item:hover {
    background-color: #f7f3eb;
    color: var(--accent-color);
}

.kebab-item.delete {
    color: #c86a5a;
    border-top: 1px solid #f0f0f0;
}
.kebab-item.delete:hover {
    background-color: #fff0f0;
}

@keyframes fadeInMenu {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}


/* === Class Accordion Styles (ç¶²æ ¼å…¼å®¹ç‰ˆ) === */
.class-group-header {
    background: #fdfbf7;
    padding: 1rem 1.2rem;
    border: 1px solid #e1d8c8;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
    color: var(--title-color);
    transition: all 0.2s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}

.class-group-header:hover { 
    background: #f4ede2; 
    transform: translateX(2px);
}

.class-group-content {
    /* é è¨­éš±è— */
    display: none; 
    padding: 0.5rem 0 2rem 0;
    animation: fadeIn 0.3s ease;
}

/* ç•¶åŠ ä¸Š .active class æ™‚ï¼Œè®Šæˆç¶²æ ¼é¡¯ç¤º (é€™æ˜¯é—œéµï¼) */
.class-group-content.active { 
    display: grid; 
    /* ç¢ºä¿èˆ‡ä¸Šé¢çš„ grid è¨­å®šä¸€è‡´ */
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.2rem;
}

@keyframes fadeIn { 
    from { opacity: 0; transform: translateY(-5px); } 
    to { opacity: 1; transform: translateY(0); } 
}

/* === Phase 2.2 æ–°å¢æ¨£å¼ (Page 1 ç¾åŒ–ç‰ˆ) === */
.setup-mode-switch {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.2rem;
  margin-bottom: 1.5rem;
}

.mode-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1.2rem;
  border: 2px solid #e1d8c8;
  border-radius: 12px;
  background: #fff;
  cursor: pointer;
  color: #8d775f;
  transition: all 0.2s;
  position: relative;
}

.mode-card input { position: absolute; opacity: 0; } /* éš±è—åœ“é» */

.mode-card:has(input:checked) {
  border-color: var(--accent-color);
  background-color: #f0f7f4;
  color: var(--accent-color);
  font-weight: bold;
  box-shadow: 0 4px 10px rgba(90,143,123,0.15);
}

.student-checklist-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  gap: 0.8rem;
  margin-top: 1rem;
  max-height: 300px;
  overflow-y: auto;
  padding: 0.8rem;
  border: 2px dashed #e1d8c8;
  border-radius: 12px;
  background: #fcfaf6;
}

.student-check-card {
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 0.8rem 0.5rem; /* ä¸Šä¸‹åŠ é—Šï¼Œå·¦å³ç¸®çª„ */
  text-align: center;     /* æ–‡å­—ç½®ä¸­ */
  font-size: 0.95rem;
  cursor: pointer;
  user-select: none;
  
  /* Flexbox ç½®ä¸­æ ¸å¿ƒ */
  display: flex;
  flex-direction: column; /* å‚ç›´æ’åˆ— (Checkbox åœ¨ä¸Šï¼Œå­—åœ¨ä¸‹) */
  align-items: center;
  justify-content: center;
  gap: 8px;
  min-height: 80px; /* ç¢ºä¿å¡ç‰‡æœ‰ä¸€è‡´é«˜åº¦ */
}

/* éš±è— Checkbox (ç”¨å¡ç‰‡é¡è‰²é¡¯ç¤ºç‹€æ…‹) */
.student-check-card input { display: none; }

/* é¸ä¸­ç‹€æ…‹ */
.student-check-card.checked {
  background-color: #eef7f4;
  border-color: var(--accent-color);
  color: var(--title-color);
  font-weight: bold;
  box-shadow: 0 0 0 1px var(--accent-color); /* åŠ å¼·é‚Šæ¡† */
}

.student-check-card.checked {
  background-color: #eef7f4;
  border-color: var(--accent-color);
  color: var(--title-color);
  font-weight: bold;
  box-shadow: 0 2px 0 var(--accent-color);
}
.student-check-card input { display: none; }

/* ========================================= */
/* === [Step 2] è©•èªåº«æ•‘æ´å¡ç‰‡ (Rescue UI) === */
/* ========================================= */

.rescue-card {
  background: #ffffff;
  border: 1px solid #e1d8c8; /* å¯¦ç·šï¼ŒCozy é¢¨æ ¼ */
  border-radius: 20px;
  padding: 40px 30px;
  text-align: center;
  box-shadow: 0 15px 40px rgba(90, 143, 123, 0.08); /* æ·¡æ·¡çš„ç¶ è‰²é™°å½± */
  margin: 20px 0;
  animation: fadeIn 0.5s ease-out;
}

.rescue-title {
  font-size: 1.6rem;
  font-weight: 700;
  color: #5A8F7B;
  margin: 0 0 10px 0;
}

.rescue-desc {
  font-size: 1rem;
  color: #8c867a;
  margin-bottom: 30px;
  line-height: 1.6;
}

.rescue-grid {
  display: flex;
  gap: 20px;
  justify-content: center;
  flex-wrap: wrap;
}

.rescue-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 140px;
  padding: 20px 15px;
  background: #fdfbf7;
  border: 2px solid #f0ebe4;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
  text-align: center;
  color: #5b5044;
}

.rescue-btn:hover {
  transform: translateY(-5px);
  border-color: #5A8F7B;
  background: #fff;
  box-shadow: 0 10px 20px rgba(90, 143, 123, 0.15);
}

.rescue-icon {
  font-size: 2.5rem;
  margin-bottom: 12px;
}

.rescue-label {
  font-weight: 600;
  font-size: 1rem;
}

.rescue-sub {
  font-size: 0.8rem;
  color: #aaa;
  margin-top: 4px;
}

/* ================================================= */
/* === [Pro-v9.9.8] ç™»å…¥ç‰†æ¨£å¼ (Clean & Force) === */
/* ================================================= */

/* 1. å…¨è¢å¹•é®ç½© (å¼·åˆ¶ç½®é ‚ + ç£¨ç ‚èƒŒæ™¯) */
#login-gate {
  position: fixed !important;
  top: 0; left: 0; right: 0; bottom: 0;
  
  /* æ·±ç¶ è‰²èƒŒæ™¯ + å¼·åŠ›æ¨¡ç³Š (ä¿ç•™ Cozy é¢¨æ ¼) */
  background: rgba(47, 79, 79, 0.9) !important; 
  backdrop-filter: blur(15px) !important; 
  
  z-index: 2147483647 !important; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  padding: 20px !important;
  
  /* é è¨­é¡¯ç¤º */
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  
  /* éå ´å‹•ç•« */
  transition: opacity 0.8s cubic-bezier(0.22, 1, 0.36, 1), visibility 0.8s;
}

/* 2. è§£é–ç‹€æ…‹ (æ¶ˆå¤±) */
#login-gate.unlocked {
  opacity: 0 !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* 3. å¡ç‰‡æœ¬é«” (æ©«å‘å¤§æ°£ç‰ˆ) */
.gate-card {
  /* ç»ç’ƒè³ªæ„Ÿï¼šåŠé€æ˜ç™½åº• + é™°å½± */
  background: rgba(255, 255, 255, 0.95) !important;
  box-shadow: 0 40px 100px rgba(0,0,0,0.5) !important;
  border: 1px solid rgba(255,255,255,0.6) !important;
  border-radius: 24px !important;
  
  /* å°ºå¯¸è¨­å®š */
  width: 100% !important;
  max-width: 550px !important; /* é—Šåº¦é©ä¸­ */
  padding: 50px 40px !important;
  
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
}

/* 4. å…§éƒ¨å…ƒç´ æ’ç‰ˆ */
.gate-input-group {
  width: 100% !important;
  max-width: 380px !important;
  text-align: left !important;
}

.gate-links {
  width: 100% !important;
  max-width: 380px !important;
  margin-top: 30px !important;
  padding-top: 20px !important;
  border-top: 1px solid rgba(0,0,0,0.1) !important;
  
  display: flex !important;
  justify-content: space-between !important;
  font-size: 0.9rem !important;
}

/* æ‰‹æ©Ÿç‰ˆå¾®èª¿ */
@media (max-width: 600px) {
  .gate-card {
    padding: 30px 20px !important;
    max-width: 90% !important;
  }
}
/* ===== [v10.4] Cozy Dashboard Styles ===== */

.folder-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1.5rem;
}

/* æ–‡ä»¶å¤¾å¡ç‰‡ */
.cozy-folder {
  background: #ffffff;
  border-radius: 16px;
  padding: 1.5rem;
  position: relative;
  box-shadow: 0 4px 6px rgba(0,0,0,0.02);
  border: 1px solid rgba(0,0,0,0.05);
  transition: all 0.3s ease;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  min-height: 160px;
}

.cozy-folder:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(90, 143, 123, 0.1);
  border-color: var(--accent-color-soft);
}

/* é ‚éƒ¨æ¨™ç±¤è£é£¾ */
.cozy-folder::before {
  content: "";
  position: absolute;
  top: 0; left: 24px;
  width: 60px; height: 6px;
  background: var(--accent-color);
  border-radius: 0 0 6px 6px;
  opacity: 0.6;
}

.folder-meta {
  margin-top: 10px;
}

.folder-class {
  font-size: 0.85rem;
  color: #9ca3af;
  font-weight: bold;
  letter-spacing: 1px;
  text-transform: uppercase;
  margin-bottom: 5px;
  display: block;
}

.folder-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--title-color);
  line-height: 1.4;
  margin-bottom: 10px;
}

.folder-stats {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.85rem;
  color: #6b7280;
  margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */
  padding-top: 15px;
  border-top: 1px dashed #f3f4f6;
}

.folder-progress-pill {
  background: #f3f4f6;
  padding: 4px 10px;
  border-radius: 99px;
  font-weight: bold;
  color: var(--accent-color);
}



/* ========================================= */
/* === [v12.1] çµ‚æ¥µ Header & UI ä¿®å¾©ç‰ˆ === */
/* ========================================= */

/* 1. Header å®¹å™¨ (Desktop & Mobile é€šç”¨) */
header {
  display: flex;
  justify-content: space-between;
  align-items: center; /* å‚ç›´ç½®ä¸­ */
  padding: 1rem 1.5rem;
  background: var(--header-bg);
  color: white;
  position: relative;
  z-index: 3000;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

/* 2. å·¦é‚Šå€åŸŸ (æ¨™é¡Œ + èº«ä»½) */
.header-left {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-width: 85%; /* ç•™ä½ä¿¾å³é‚Šé½’è¼ª */
}

header h1 {
  margin: 0;
  font-size: 1.8rem;
  font-weight: 500;
  letter-spacing: 0.1em;
  line-height: 1.2;
}

/* 3. ç™»å…¥è³‡æ–™è† å›Š */
.auth-container {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background-color: rgba(255, 255, 255, 0.15);
  padding: 4px 10px;
  border-radius: 99px;
  width: fit-content;
}

#auth-status {
  font-size: 0.8rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 200px;
}

#auth-buttons {
  display: flex;
  gap: 5px;
}

/* 4. å³é‚Šå€åŸŸ (è¨­å®šæ£) */
.header-right {
  position: relative;
  display: flex;
  align-items: center;
}

.font-control-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  background: rgba(255,255,255,0.25);
  color: #fff;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: background 0.2s;
}
.font-control-btn:hover { background: rgba(255,255,255,0.4); }

/* 5. è¨­å®šé¸å–® (å¼·åˆ¶æœ€é ‚å±¤ï¼Œè§£æ±ºé®æ“‹) */
.settings-menu-popover {
  position: absolute;
  top: 50px;
  right: 0;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 10px 60px rgba(0,0,0,0.3); /* æ·±é™°å½± */
  border: 1px solid rgba(0,0,0,0.05);
  width: 200px;
  padding: 12px;
  z-index: 2147483647 !important; /* ğŸ”¥ å®‡å®™æœ€é«˜ */
  color: #555;
  text-align: left;
}




/* ========================================================================== */
/* === [v12.1-Final] æ ¸å¿ƒå°èˆªèˆ‡ä»‹é¢æ¨£å¼ (Header, Nav, Mobile, Settings) === */
/* ========================================================================== */

/* --- 1. Header (é ‚éƒ¨æ¬„) --- */
header {
  display: flex;
  justify-content: space-between;
  align-items: center; /* å‚ç›´ç½®ä¸­ */
  padding: 1rem 1.5rem;
  background: var(--header-bg);
  color: white;
  position: relative;
  z-index: 3000;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.header-left {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-width: 85%; /* ç•™ä½ä¿¾å³é‚Šé½’è¼ª */
}

header h1 {
  margin: 0;
  font-size: 1.8rem;
  font-weight: 500;
  letter-spacing: 0.1em;
  line-height: 1.2;
}

/* ç™»å…¥è³‡æ–™è† å›Š */
.auth-container {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background-color: rgba(255, 255, 255, 0.15);
  padding: 4px 10px;
  border-radius: 99px;
  width: fit-content;
}

#auth-status {
  font-size: 0.8rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 200px;
}

#auth-buttons { display: flex; gap: 5px; }



/* è¨­å®šæŒ‰éˆ• (é½’è¼ª) */
.font-control-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  background: rgba(255,255,255,0.25);
  color: #fff;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: background 0.2s;
}
.font-control-btn:hover { background: rgba(255,255,255,0.4); }

/* --- 2. è¨­å®šé¸å–® (Settings Popover) --- */
.settings-menu-popover {
  position: absolute;
  top: 50px;
  right: 0;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 10px 60px rgba(0,0,0,0.3); /* æ·±é™°å½± */
  border: 1px solid rgba(0,0,0,0.05);
  width: 200px;
  padding: 12px;
  z-index: 2147483647 !important; /* ğŸ”¥ å®‡å®™æœ€é«˜ */
  color: #555;
  text-align: left;
}

.settings-group label {
  font-size: 0.8rem; color: #999; margin-bottom: 8px; display: block;
}

.font-controls-row {
  display: flex; gap: 5px; justify-content: space-between;
}

.font-controls-row button {
  flex: 1; padding: 6px 0; border: 1px solid #eee; background: #f9f9f9;
  border-radius: 6px; cursor: pointer; font-size: 0.9rem; color: #555;
}
.font-controls-row button:hover { background: #eee; }

.settings-divider { height: 1px; background: #eee; margin: 10px 0; }

.text-btn {
  width: 100%; text-align: left; background: transparent; border: none;
  padding: 8px; cursor: pointer; font-size: 0.95rem; color: #5b5044; border-radius: 6px;
}
.text-btn:hover { background: #f3f4f6; }

/* --- 3. å°èˆªåˆ— (Nav) --- */
.page-nav-wrapper {
  background-color: #fff;
  border-bottom: 1px solid rgba(0,0,0,0.05);
  position: relative;
  z-index: 1000;
  box-shadow: 0 2px 10px rgba(0,0,0,0.02);
}

/* ä¸»å°èˆª (å›ºå®š) */
.main-nav {
  display: flex; justify-content: center; gap: 2rem; padding: 0 1rem;
  background: transparent; height: 60px; align-items: center;
}

.nav-btn {
  background: transparent; border: none; cursor: pointer; padding: 8px 16px;
  border-radius: 12px; color: #888; font-size: 1rem; font-weight: 500;
  display: flex; align-items: center; gap: 6px; transition: all 0.2s ease; font-family: inherit;
}
.nav-btn:hover { background-color: rgba(0,0,0,0.03); color: #555; }
.nav-btn.active { color: var(--accent-color); background-color: var(--accent-color-soft); font-weight: bold; }
.nav-btn::after { display: none; }

/* å­å°èˆª (æ‡¸æµ®å³¶) */
.sub-nav-island {
  position: absolute;
  top: 65px; left: 50%; transform: translateX(-50%);
  background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.5); box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  padding: 6px 8px; border-radius: 99px;
  display: flex; gap: 5px; z-index: 1001; white-space: nowrap;
  animation: floatDown 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
}

@keyframes floatDown {
  from { opacity: 0; transform: translate(-50%, -10px); }
  to { opacity: 1; transform: translate(-50%, 0); }
}

.sub-nav-group { display: flex; gap: 5px; }

.sub-nav-btn {
  padding: 6px 16px; font-size: 0.9rem; color: #666; background: transparent;
  border: none; border-radius: 99px; cursor: pointer; transition: all 0.2s;
  font-family: inherit; white-space: nowrap;
}
.sub-nav-btn:hover { background-color: rgba(0,0,0,0.05); color: #333; }
.sub-nav-btn.active {
  background-color: var(--accent-color); color: #fff;
  box-shadow: 0 4px 10px rgba(90, 143, 123, 0.3);
}



/* ========================================= */
/* === [v12.2] Mobile RWD (çµ‚æ¥µä¿®å¾©ç‰ˆ) === */
/* ========================================= */
@media (max-width: 768px) {
  
  /* 1. Header: å·¦å°é½Š */
  header {
    padding: 15px 20px !important;
    gap: 12px !important;
    flex-direction: column !important;
    align-items: flex-start !important;
  }
  
  header h1 {
    text-align: left !important;
    font-size: 1.6rem !important;
    width: 100%;
  }

  .auth-container {
    margin: 0 !important;
    justify-content: flex-start !important;
    max-width: 75%; /* ç•™ä½ä¿¾å³é‚Š Setting æ£ */
  }
  
  /* Setting æ£ï¼šæ‹åŸ‹è† å›Šå³é‚Š */
  .header-right {
    position: absolute !important;
    top: auto !important;
    bottom: 18px !important; /* å°é½Šè† å›Š */
    right: 20px !important;
    display: block !important;
  }
  
  /* Setting é¸å–®ä½ç½®ä¿®æ­£ (å””å¥½é£›å»æœ€å³ï¼Œå””å¥½é®å­—) */
  .settings-menu-popover {
    right: 0 !important; 
    left: auto !important;
    top: 45px !important;
    width: 180px !important;
  }

  /* 2. å°èˆª Nav: ä¿®æ­£è¿«åŸ‹ä¸€é‚Šå•é¡Œ */
  .main-nav {
    justify-content: space-between !important; /* å¹³å‡åˆ†ä½ˆ */
    width: 100%;
    overflow-x: auto;
    padding: 0 10px;
  }
 /* [v12.7-MobileNav-TextFix] æ‰‹æ©Ÿç‰ˆå°èˆªï¼šéš±è—æ–‡å­—ï¼ŒIcon å±…ä¸­ */
  .nav-btn {
    flex: 1;
    justify-content: center; /* å¼·åˆ¶ç½®ä¸­ */
    padding: 8px 0;
    display: flex; /* ç¢ºä¿ Flex ç”Ÿæ•ˆ */
  }

  /* éš±è—æ–‡å­— span */
  .nav-btn .nav-text {
    display: none !important;
  }

  /* æ”¾å¤§ Icon ä¸¦ç§»é™¤é–“è· */
  .nav-btn .nav-icon {
    font-size: 1.5rem; 
    margin: 0 !important;
  }

  /* å­å°èˆª: æ©«æ»‘ + ç½®ä¸­ */
  .sub-nav-island {
    position: static;
    transform: none;
    width: 100%;
    border-radius: 0;
    background: #fcfcfc;
    padding: 12px 0;
    
    /* ğŸ”¥ é—œéµï¼šä½¿ç”¨ Flex ä»¤å…¶ç½®ä¸­ */
    display: flex;
    justify-content: center; 
    gap: 8px;
  }
  
  /* ä¿®æ­£å­é¸å–®æŒ‰éˆ• */
  .sub-nav-btn {
    border: 1px solid #eee;
    background: #fff;
    font-size: 0.85rem;
    padding: 6px 14px;
    border-radius: 99px;
    flex-shrink: 0;
  }
  
  .sub-nav-btn.active {
    background: var(--accent-color);
    color: #fff;
    box-shadow: 0 2px 5px rgba(90,143,123,0.3);
  }

  /* 3. é€šç”¨ä¿®æ­£ */
  .font-control-btn { width: 36px !important; height: 36px !important; }
  
  /* è¡¨æ ¼å¡ç‰‡åŒ– */
  #student-overview-table-wrapper { width: 100% !important; border: none !important; box-shadow: none !important; }
  #student-overview-table, #student-overview-table tbody, #student-overview-table tr, #student-overview-table td { display: block !important; width: 100% !important; }
  #student-overview-table thead { display: none !important; }
  #student-overview-table tr { margin-bottom: 20px; border: 2px solid var(--accent-color); border-radius: 12px; padding: 15px; background: #fff; }
  #student-overview-table td { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #eee; text-align: right; }
  #student-overview-table td:last-child { border-bottom: none; }
  #student-overview-table td::before { content: attr(data-label-fix); font-weight: bold; color: var(--accent-color); text-align: left; margin-right: 10px; }
  /* è£œå›æ¬„ä½åç¨± */
  #student-overview-table td:nth-of-type(1)::before { content: "å­¸è™Ÿ"; }
  #student-overview-table td:nth-of-type(2)::before { content: "å§“å"; }
  #student-overview-table td:nth-of-type(3)::before { content: "å…§å®¹"; }
  #student-overview-table td:nth-of-type(4)::before { content: "è¡¨é”"; }
  #student-overview-table td:nth-of-type(5)::before { content: "çµæ§‹"; }
  #student-overview-table td:nth-of-type(6)::before { content: "æ¨™é»"; }
  #student-overview-table td:nth-of-type(7)::before { content: "éŒ¯åˆ¥å­—"; }
  #student-overview-table td:nth-of-type(8)::before { content: "ç¸½åˆ†"; }
  #student-overview-table td:nth-of-type(9)::before { content: "è©•èª"; }
  #student-overview-table td:nth-of-type(10) { display: none; }
}

/* ========================================= */
/* === [v12.2] å”¯ä¸€ Back To Top æ¨£å¼ (å·²ä¿®å¾©) === */
/* ========================================= */
#back-to-top-btn {
  display: none; /* JS æ§åˆ¶é¡¯ç¤º */
  position: fixed !important; /* å¼·åˆ¶è„«é›¢æ–‡æª”æµï¼Œæµ®åœ¨è¦–çª—ä¹‹ä¸Š */
  bottom: 30px;
  right: 30px;
  z-index: 2147483647; /* å®‡å®™æœ€é«˜ï¼Œç¢ºä¿å””æœƒè¢«é® */
  
  width: 45px;
  height: 45px;
  border-radius: 50%;
  
  /* æ¥µè‡´é€æ˜é¢¨æ ¼ */
  background-color: rgba(255, 255, 255, 0.3); 
  border: 1px solid rgba(0, 0, 0, 0.05);
  color: var(--accent-color); /* ç¶ è‰²ç®­å˜´ */
  
  cursor: pointer;
  font-size: 1.5rem; /* ç®­å˜´å¤§ç²’å•² */
  line-height: 1;
  
  /* æŸ”å’Œéæ¸¡ */
  transition: all 0.3s ease;
  backdrop-filter: blur(4px); /* ç£¨ç ‚æ•ˆæœ */
}

/* Hover æ™‚æ‰è®Šå¯¦è‰²ï¼Œæ–¹ä¾¿é»æ“Š */
#back-to-top-btn:hover {
  background-color: var(--accent-color);
  color: white;
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(90, 143, 123, 0.3);
}
/* [v12.1] Hotfix: è§£æ±ºé®æ“‹èˆ‡è·³å‹• */

/* 1. é›»è…¦ç‰ˆ Setting é¸å–® (å¼·åˆ¶è„«é›¢çˆ¶å®¹å™¨) */
@media (min-width: 769px) {
    .settings-menu-popover {
        position: fixed !important; /* ç”± absolute æ”¹ç‚º fixed */
        top: 70px !important;       /* å›ºå®šåœ¨ Header ä¸‹æ–¹ */
        right: 30px !important;     /* é å³ */
        left: auto !important;
        z-index: 2147483647 !important; /* å®‡å®™æœ€é«˜ */
        /* ç¢ºä¿å””æœƒå— Header çš„ overflow:hidden å½±éŸ¿ */
    }
}

/* 2. æ‰‹æ©Ÿç‰ˆå°èˆª (é è¨­éš±è—ï¼ŒJS è¼‰å…¥å¾Œé¡¯ç¤ºï¼Œé˜²æ­¢é–ƒå·¦é‚Š) */
.sub-nav-island {
    opacity: 0; 
    animation: fadeInNav 0.3s ease forwards; /* è¼‰å…¥æ™‚æ·¡å…¥ */
}

@keyframes fadeInNav {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* [v12.8-MobileNav-DisplayFix] æ‰‹æ©Ÿç‰ˆå¼·åˆ¶ç½®ä¸­ (ä¿®å¾©é¦–é ç°æ¢å•é¡Œ) */
@media (max-width: 768px) {
    .sub-nav-island {
        justify-content: center !important; /* å¼·åˆ¶ç½®ä¸­ */
        /* ğŸ”¥ é—œéµä¿®æ­£ï¼šç§»é™¤ display: flex !important; */
        /* è®“ JS æ±ºå®šå¹¾æ™‚é¡¯ç¤º (flex) å¹¾æ™‚éš±è— (none) */
    }
}


/* =================================================== */
/* === [v12.5] çµ‚æ¥µæ¨£å¼è£œä¸ (Header, Nav, TopBtn) === */
/* =================================================== */

/* 1. Back To Top (å¼·åˆ¶æ‡¸æµ®å³ä¸‹è§’) */
#back-to-top-btn {
  display: none; /* JS æ§åˆ¶ */
  position: fixed !important;
  bottom: 30px;
  right: 30px;
  z-index: 2147483647;
  width: 45px; height: 45px; border-radius: 50%;
  background-color: rgba(90, 143, 123, 0.3); /* åŠé€æ˜ç¶  */
  color: #fff; border: none; cursor: pointer; font-size: 1.4rem;
  backdrop-filter: blur(4px); transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
#back-to-top-btn:hover {
  background-color: var(--accent-color); opacity: 1; transform: translateY(-3px);
}

/* 2. é›»è…¦ç‰ˆ Setting é¸å–® (é˜²æ­¢è¢«é®) */
.settings-menu-popover {
  position: fixed !important;
  top: 70px !important; right: 30px !important; left: auto !important;
  z-index: 2147483647 !important;
  box-shadow: 0 10px 60px rgba(0,0,0,0.3) !important;
}

/* 3. å°èˆªæ‡¸æµ®å³¶ (é›»è…¦ç‰ˆç½®ä¸­ä¿®æ­£) */
.sub-nav-island {
  position: absolute;
  top: 65px; left: 50%; transform: translateX(-50%);
  background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
  border: 1px solid rgba(0,0,0,0.05); box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  padding: 6px 8px; border-radius: 99px;
  display: flex; gap: 5px; z-index: 1001; white-space: nowrap;
  /* ä½¿ç”¨ JS é¡¯ç¤ºæ™‚æœƒè‡ªå‹•å¥—ç”¨ Flexï¼Œç„¡éœ€å‹•ç•«ä»¥å…ç§»ä½ */
}



/* ========================================= */
/* === [v12.6] å°èˆªç½®ä¸­å¼·åŠ›ä¿®æ­£ (Hammer Fix) === */
/* ========================================= */

/* 1. å®šç¾©ä¸€å€‹ã€Œçµ•å°ç½®ä¸­ã€çš„å‹•ç•« (å¿…é ˆåŒ…å« translate -50%) */
/* ä¹‹å‰æ­ªå’—ä¿‚å› ç‚ºå‹•ç•«å…¥é¢å†‡åŒ…å« -50%ï¼Œæ‰€ä»¥ä¸€éƒå°±èµ°ä½ */
@keyframes floatDownCenterFixed {
  from { opacity: 0; transform: translate(-50%, -10px); }
  to { opacity: 1; transform: translate(-50%, 0); }
}

/* 2. é›»è…¦ç‰ˆæ‡¸æµ®å³¶ (å¼·åˆ¶æ‡‰ç”¨ç½®ä¸­å‹•ç•«) */
@media (min-width: 769px) {
  .sub-nav-island {
    left: 50% !important;
    transform: translateX(-50%) !important; /* éœæ­¢ç‹€æ…‹ï¼šç½®ä¸­ */
    
    /* ğŸ”¥ é—œéµï¼šå‹•ç•«ç‹€æ…‹ä¹Ÿè¦ç½®ä¸­ */
    animation: floatDownCenterFixed 0.3s cubic-bezier(0.2, 0.8, 0.2, 1) forwards !important;
    
    /* é–æ­»å…¶ä»–å¯èƒ½å½±éŸ¿å®šä½å˜…å±¬æ€§ */
    margin: 0 !important;
    right: auto !important;
    top: 65px !important;
  }
}

/* 3. æ‰‹æ©Ÿç‰ˆé˜²ç¦¦ (ç¢ºä¿å””æœƒå—å½±éŸ¿) */
@media (max-width: 768px) {
  .sub-nav-island {
    transform: none !important;
    left: 0 !important;
    animation: none !important; /* æ‰‹æ©Ÿå””è¦å‹•ç•«ï¼Œè²»äº‹é–ƒ */
    opacity: 1 !important;
    justify-content: center !important;
  }
}
/* ====================================================== */
/* [æœ€çµ‚ä¿®æ­£ CSS] æ¼¢å ¡åŒ…é¸å–®æ¨£å¼ (Mobile Hamburger Menu) */
/* ä½œç”¨ï¼šå°‡åˆ†é æ¬„è®Šæˆå³ä¸Šè§’å½ˆå‡º Menu */
/* ====================================================== */

/* 1. æ¼¢å ¡åŒ…æŒ‰éˆ•æ¨£å¼ (å›ºå®šåœ¨å³ä¸Šè§’) */
#mobile-menu-btn {
    position: fixed;
    top: 15px;      
    right: 15px;    
    z-index: 10001; 
    
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid #ccc;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    
    width: 42px; height: 42px; 
    border-radius: 8px;
    cursor: pointer;
    font-size: 20px;
    color: #444;
    
    /* é è¨­éš±è—ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º/éš±è— */
    display: none; 
    align-items: center; justify-content: center;
}

/* 2. æ‰‹æ©Ÿç‰ˆï¼šæ”¹é€ åˆ†é æ¬„ (è®Šæˆå½ˆå‡ºå¼ Menu) */
@media screen and (max-width: 768px) {
    
    /* é è¨­å¼·åˆ¶éš±è—åˆ†é æ¬„ï¼Œäº¤ç”± JS æ§åˆ¶çš„ .show-menu åšŸæ‰“é–‹ */
    #sub-nav-container {
        display: none !important; 
        
        /* å½ˆå‡ºé¸å–®æ¨£å¼ */
        position: fixed !important;
        top: 65px;      
        right: 15px;    
        z-index: 10000;
        
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        padding: 8px;
        
        /* æ’ç‰ˆï¼šç›´æ’ */
        flex-direction: column !important;
        width: 150px !important; 
        gap: 5px !important;
    }

    /* åªæœ‰ç•¶ JS åŠ ä¸Š .show-menu class å…ˆè‡³é¡¯ç¤º */
    #sub-nav-container.show-menu {
        display: flex !important;
        animation: slideIn 0.2s ease-out;
    }
    
    /* æŒ‰éˆ•æ¨£å¼èª¿æ•´ */
    .sub-nav-btn {
        width: 100% !important; 
        text-align: left !important; 
        padding: 10px 12px !important;
        font-size: 14px !important;
        border-radius: 6px !important;
        background: transparent !important;
        margin: 0 !important;
    }
    
    /* å‹•ç•«æ•ˆæœ */
    @keyframes slideIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
}

/* ========================================= */
/* === [Edition: æ›¸ v13.1] Frosted UI === */
/* ========================================= */

#mobile-book-trigger, #mobile-book-overlay { display: none; }
/* 1. æ›¸ç±¤æŒ‰éˆ•ï¼šç§»è‡³ Header (éš±è—åŸæœ¬åº•éƒ¨çš„) */
#mobile-book-trigger { display: none !important; }

/* 2. æ‰‹æ©Ÿç‰ˆæ›¸ç±¤æ£ (å¯¦è‰²é«˜å°æ¯”ç‰ˆ) */
.header-book-btn {
    display: none;
    /* ğŸ”¥ æ”¹ç”¨å¯¦å¿ƒå¥¶ç™½è‰²ï¼Œå°æ¯” Header çš„ç¶ è‰² */
    background: #fdfbf7; 
    color: var(--accent-color); /* åœ–æ¡ˆç”¨æ·±ç¶ è‰² */
    border: 2px solid rgba(255,255,255,0.5); /* åŠ å€‹å…‰æšˆé‚Šæ¡† */
    width: 40px;
    height: 40px;
    border-radius: 12px; /* åœ“è§’æ–¹å¡Šï¼Œä¼¼ App Icon */
    align-items: center;
    justify-content: center;
    font-size: 1.3rem;
    margin-right: 12px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* æµ®èµ·æ„Ÿ */
    transition: transform 0.1s;
}

@media (max-width: 768px) {
    .header-book-btn { display: flex; }
    
    /* è®“ Header å³é‚Šå¯¬é¬†å•² */
    .header-right { gap: 8px; }
}

.header-book-btn:active {
    transform: scale(0.92);
    background: #fff;
}

@media (max-width: 768px) {
    /* 2. æ‰‹æ©Ÿç‰ˆé€²åº¦è¡¨æ–‡å­—æº¢å‡ºä¿®å¾© */
    #student-overview-table textarea {
        width: 100% !important;
        box-sizing: border-box !important; /* é—œéµï¼šé˜²æ­¢ padding æ’çˆ† */
        white-space: pre-wrap !important;  /* å…è¨±æ›è¡Œ */
        word-break: break-word !important; /* é•·å­—è‡ªå‹•æ–·è¡Œ */
    }
    #student-overview-table td {
        overflow: hidden; /* é˜²æ­¢æ’çˆ† TD */
    }
}


@media (max-width: 768px) {
    /* 1. éš±è—èˆŠ Header Nav */
    .page-nav-wrapper { display: none !important; }

  /* [Edition v13.2] ç»ç’ƒæ›¸ç±¤æŒ‰éˆ• (Glass Bookmark) */
    #mobile-book-trigger {
        /* å®šä½ (ä¿æŒä¸è®Š) */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: fixed;
        bottom: 25px;
        right: 20px;
        width: 60px;
        height: 60px;
        z-index: 2000;
        cursor: pointer;

        /* âœ¨ ç»ç’ƒæ“¬æ…‹ (Glassmorphism) æ ¸å¿ƒè¨­å®š âœ¨ */
        background: rgba(255, 255, 255, 0.65); /* æ¥µæ·¡å¥¶ç™½ï¼Œé«˜é€æ˜åº¦ */
        backdrop-filter: blur(12px);           /* å¼·åŠ›ç£¨ç ‚ï¼Œæ¨¡ç³ŠèƒŒå¾Œå…§å®¹ */
        -webkit-backdrop-filter: blur(12px);   /* Safari æ”¯æ´ */
        border: 1px solid rgba(255, 255, 255, 0.8); /* äº®ç™½é‚Šæ¡†ï¼Œæ‰®ç»ç’ƒé‚Šç·£ */
        
        /* å½¢ç‹€èˆ‡é™°å½± */
        border-radius: 18px; /* åœ“æ½¤æ–¹å¡Šï¼Œä¼¼ä¸€å¡Šå°ç»ç’ƒç£š */
        box-shadow: 
            0 4px 6px rgba(0, 0, 0, 0.05),  /* è²¼èº«é™°å½± */
            0 10px 25px rgba(0, 0, 0, 0.1); /* æ“´æ•£é™°å½±ï¼Œç‡Ÿé€ æµ®èµ·æ„Ÿ */
        
        /* æ–‡å­—èˆ‡ Icon é¡è‰² (æ·±ç°ç¶ ï¼Œè¦åœ¨æ·ºåº•ä¸Šå¤ æ¸…æ¥š) */
        color: #3d5c4f; 
        transition: all 0.3s ease;
    }

    /* æŒ‰ä¸‹å»çš„å¾®äº’å‹• */
    #mobile-book-trigger:active {
        transform: scale(0.95);
        background: rgba(255, 255, 255, 0.85); /* æŒ‰ä¸‹è®Šå¯¦è‰²å°‘å°‘ */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    /* ğŸ”¥ 3. è§£æ±ºé‡ç–Šï¼šå¼·åˆ¶æ¨é«˜ã€Œæ‰¹æ”¹é ã€çš„æµ®å‹•å°èˆªåˆ— */
    /* é€™æ˜¯ Page 2 åŸæœ‰çš„å·¥å…·åˆ—ï¼Œæˆ‘å€‘è®“å®ƒæµ®åœ¨æ›¸ç±¤ä¸Šæ–¹ */
    #floating-nav {
        bottom: 95px !important; /* åŸæœ¬æ˜¯ 25pxï¼Œç¾åœ¨æ¨é«˜åˆ° 95pxï¼Œé¿é–‹æ›¸ç±¤ */
        right: 20px !important;
        left: auto !important;
        transform: none !important; /* ç§»é™¤åŸæœ¬çš„ç½®ä¸­è®Šæ› */
        
        /* è®Šç‚ºå‚ç›´æ’åˆ—ï¼Œæ…³ä½ */
        flex-direction: column !important;
        background: rgba(255, 255, 255, 0.85) !important;
        padding: 8px !important;
        width: auto !important;
        border-radius: 99px !important;
    }

    /* Back to Top æ£ä¹Ÿè¦æ¨é«˜ */
    #back-to-top-btn {
        bottom: 100px !important; 
        right: 80px !important; /* æ”¾åœ¨å·¦é‚Šä¸€é»ï¼Œé¿å…æ’è»Š */
    }

    /* 4. å…¨è¢å¹•ç£¨ç ‚ç›®éŒ„ (Overlay) */
    #mobile-book-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        
        /* âœ¨ æ ¸å¿ƒç¾åŒ–ï¼šåŠé€æ˜å¥¶ç™½è‰² + ç£¨ç ‚ç‰¹æ•ˆ */
        background: rgba(253, 251, 247, 0.85); 
        backdrop-filter: blur(12px); /* ç£¨ç ‚ç»ç’ƒæ„Ÿ */
        -webkit-backdrop-filter: blur(12px); /* Safari æ”¯æ´ */
        
        z-index: 3001;
        display: flex;
        flex-direction: column;
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
        padding: 20px 25px;
        overflow-y: auto;
    }

    #mobile-book-overlay.active {
        opacity: 1;
        pointer-events: auto;
    }

    /* æ¨™é¡Œç¾åŒ– */
    .book-menu-title {
        text-align: center;
        color: #5b5044;
        font-size: 1.4rem;
        font-weight: 500;
        margin-top: 20px;
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(0,0,0,0.08); /* æ¥µæ·¡é‚Šæ¡† */
        letter-spacing: 3px;
    }

    /* åˆ—è¡¨é …ç›®ç¾åŒ– */
    .book-main-item {
        font-size: 1.2rem;
        color: #5b5044;
        padding: 18px 10px;
        border-bottom: 1px dashed rgba(0,0,0,0.05); /* æ›´æ·¡çš„è™›ç·š */
        transition: background 0.2s;
        border-radius: 8px;
    }
    
    .book-main-item:active {
        background: rgba(255, 255, 255, 0.5);
    }

    /* å±•é–‹æ™‚çš„æ•ˆæœ */
    .book-main-item.expanded .book-main-header {
        color: var(--accent-color);
        font-weight: 600;
    }

    /* ç®­å˜´ */
    .book-arrow {
        opacity: 0.4;
        font-size: 0.7rem;
    }

    /* å­é¸å–®å€åŸŸ */
    .book-sub-list {
        background: rgba(255, 255, 255, 0.4); /* æ¥µæ·¡ç™½åº• */
        border-radius: 12px;
        margin-top: 5px;
        box-shadow: inset 0 2px 6px rgba(0,0,0,0.02); /* å…§é™°å½±å¢åŠ å‡¹é™·æ„Ÿ */
    }

    .book-sub-item {
        padding: 14px 15px 14px 50px;
        font-size: 0.95rem;
        color: #777;
        position: relative;
    }
    
    /* å­é¸å–®å‰é¢çš„å°åœ“é» */
    .book-sub-item::before {
        content: "";
        position: absolute;
        left: 30px;
        top: 50%;
        transform: translateY(-50%);
        width: 4px;
        height: 4px;
        background: #ccc;
        border-radius: 50%;
    }
    
    .book-sub-item:active {
        color: var(--accent-color);
        background: rgba(255,255,255,0.8);
    }
    .book-sub-item:active::before {
        background: var(--accent-color);
    }
    
    /* é—œé–‰æŒ‰éˆ• */
    .book-close-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 40px; 
        height: 40px;
        border-radius: 50%;
        background: rgba(0,0,0,0.05);
        border: none;
        color: #888;
        font-size: 1.2rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }
}
/* === [v11.0] AI é é¢ç¾åŒ– (Cozy & Clean) === */

/* 1. æ¡Œé¢ç‰ˆé›™æ¬„ä½ˆå±€ (å·¦é‚Šè¨­å®šï¼Œå³é‚Šæ“ä½œ) */
@media (min-width: 900px) {
    .ai-page-grid {
        display: grid;
        grid-template-columns: 1fr 1.2fr; /* å·¦çª„å³é—Š */
        gap: 30px;
        align-items: start;
    }
}

/* 2. é­”æ³•å¡ç‰‡ (å–ä»£åŸæœ¬æ²ˆæ‚¶çš„æ¡†æ¡†) */
.ai-magic-card {
    background: #fff;
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 8px 20px rgba(90, 143, 123, 0.08); /* æ·¡æ·¡çš„ç¶ è‰²å…‰æšˆ */
    border: 1px solid rgba(0,0,0,0.03);
    position: relative;
    overflow: hidden;
}

/* è£é£¾ç”¨çš„å’–å•¡åœ–æ¡ˆèƒŒæ™¯ (éš¨æ„ï¼Œå¢åŠ æ°£æ°›) */
.ai-magic-card::before {
    content: "â˜•ï¸";
    position: absolute;
    top: -10px;
    right: -10px;
    font-size: 5rem;
    opacity: 0.05;
    pointer-events: none;
}

/* 3. æ­¥é©Ÿæ¨™é¡Œ */
.ai-step-title {
    font-size: 1.1rem;
    font-weight: bold;
    color: var(--title-color);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* 4. éš±è—å¼æŠ€è¡“ç´°ç¯€ (<details>) */
.tech-details {
    margin-top: 15px;
    border-top: 1px dashed #eee;
    padding-top: 10px;
}
.tech-details summary {
    font-size: 0.85rem;
    color: #aaa;
    cursor: pointer;
    list-style: none; /* éš±è—é è¨­ç®­å˜´ */
}
.tech-details summary:hover {
    color: var(--accent-color);
}
.tech-textarea {
    width: 100%;
    font-family: monospace;
    font-size: 0.8rem;
    color: #666;
    background: #f9f9f9;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 10px;
    margin-top: 10px;
}

/* 5. æº«æš–çš„æç¤ºæ–‡å­— */
.cozy-hint {
    font-size: 0.9rem;
    color: #8c867a;
    line-height: 1.6;
    background: #fcfaf6;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    border-left: 4px solid var(--accent-color);
}
/* ========================================= */
/* === [v11.3] UI å¾®èª¿ (Toast & Hint) === */
/* ========================================= */

/* 1. ä¿®å¾© Pop-up (Toast) æ‰‹æ©Ÿé¡¯ç¤ºå•é¡Œ */
.toast-notification {
    white-space: normal !important; /* é—œéµï¼šå…è¨±æ–‡å­—æ›è¡Œ */
    max-width: 85vw !important;     /* é™åˆ¶æœ€å¤§å¯¬åº¦ç‚ºè¢å¹• 85% */
    width: auto !important;
    height: auto !important;
    
    /* æ’ç‰ˆèª¿æ•´ */
    display: flex !important;
    align-items: flex-start !important; /* Icon èˆ‡æ–‡å­—é ‚éƒ¨å°é½Š */
    text-align: left !important;        /* æ–‡å­—é å·¦ï¼Œé–±è®€è¼ƒèˆ’æœ */
    padding: 12px 16px !important;
    line-height: 1.5 !important;
    
    /* ä½ç½®å¾®èª¿ (é¿å…é®æ“‹é ‚éƒ¨å¤ªå¤š) */
    top: 30px !important; 
}

/* 2. é‡è£½ Cozy Hint (å»é™¤ Quote æ¨£å¼) */
.cozy-hint {
    /* ç§»é™¤åŸæœ¬çš„å·¦é‚Šç²—ç·š */
    border-left: none !important;
    
    /* æ”¹ç”¨æ¥µæ·¡çš„ã€Œä¾¿æ¢ç´™ã€é¢¨æ ¼ */
    background-color: rgba(255, 255, 255, 0.6); /* åŠé€æ˜ç™½åº• */
    border: 1px dashed #d1e2d9; /* æ¥µæ·¡çš„ç¶ è‰²è™›ç·šæ¡† */
    border-radius: 12px;
    padding: 15px 18px;
    
    /* æ–‡å­—è¨­å®š */
    color: #666;
    font-size: 0.9rem;
    line-height: 1.6;
    margin-bottom: 20px;
    
    /* å½ˆæ€§ä½ˆå±€ï¼Œè®“ Icon åœ¨å·¦é‚Š */
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

/* åˆ©ç”¨å½å…ƒç´ åŠ ä¸€å€‹å¯æ„› Iconï¼Œä¸éœ€æ”¹ HTML */
.cozy-hint::before {
    content: "ğŸ’¡"; /* ç‡ˆæ³¡æˆ–è€… âœ¨ */
    font-size: 1.1rem;
    flex-shrink: 0; /* å›ºå®šå¤§å°ï¼Œä¸æœƒè¢«å£“æ‰ */
    margin-top: 2px; /* å¾®èª¿å°é½Š */
}

/* 1. Header è¨­å®šæ£å¾®èª¿ (èå…¥ Auth Group) */
#auth-buttons .font-control-btn {
    width: 28px;
    height: 28px;
    font-size: 1rem;
    border: none;
    background: transparent;
    color: rgba(255,255,255,0.8);
    margin-left: 5px;
    box-shadow: none;
}
#auth-buttons .font-control-btn:hover {
    color: #fff;
    transform: rotate(30deg);
}
/* ========================================= */
/* === [v19.3] é›œèªŒé¢¨å ±å‘Š (Magazine A4) === */
/* ========================================= */

/* [v19.2] PDF åˆ—å°ä¿®å¾© (å®Œæ•´æ¨£å¼ç‰ˆ) */

/* 1. å¹³æ™‚éš±è—åˆ—å°å®¹å™¨ */
#print-container { display: none; }

/* [v19.9] PDF åˆ—å°çµ‚æ¥µä¿®æ­£ (é‡ç½®é«˜åº¦èˆ‡æº¢å‡º) */
@media print {
    /* 1. éš±è—æ‰€æœ‰éåˆ—å°å…ƒç´  */
    body > :not(#print-container) {
        display: none !important;
    }

    /* 2. é¡¯ç¤ºåˆ—å°å®¹å™¨ */
    #print-container {
        display: block !important;
        position: relative !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background-color: white !important;
        visibility: visible !important;
    }

    /* 3. ç¢ºä¿å®¹å™¨å…§å®¹å¯è¦‹ */
    #print-container * {
        visibility: visible !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    /* 4. é—œéµï¼šé‡ç½® Body é«˜åº¦ï¼Œé˜²æ­¢è¢«æˆªæ–· */
    html, body {
        height: auto !important;
        min-height: 100% !important;
        overflow: visible !important;
        margin: 0 !important;
        padding: 0 !important;
        background: #fff !important;
    }

    /* 5. é é¢è¨­å®š */
    @page {
        size: A4 portrait;
        margin: 0;
    }
}

/* 3. å ±å‘Šæ¨£å¼ (é›œèªŒé¢¨ - ä¿ç•™åŸæ¨£) */
.report-page {
    width: 210mm;
    min-height: 297mm;
    margin: 0 auto;
    background: #fff;
    font-size: 12pt; 
    font-family: "LXGW WenKai TC", serif;
    color: #444;
    position: relative;
    page-break-after: always;
    padding: 20mm; 
    box-sizing: border-box;
}

/* è£é£¾æ€§é‚Šæ¡† */
.report-page::before {
    content: "";
    position: absolute;
    top: 10mm; left: 10mm; right: 10mm; bottom: 10mm;
    border: 1px solid #ddd;
    pointer-events: none;
}

/* é é ­ */
.report-header {
    margin-bottom: 30px;
    border-bottom: 2px solid #5A8F7B;
    padding-bottom: 15px;
    position: relative;
}

.report-title-block h1 {
    font-size: 24pt;
    font-weight: normal;
    color: #2c3e50;
    margin: 0;
    letter-spacing: 2px;
}

.report-sub-title {
    font-size: 14pt;
    color: #5A8F7B;
    margin-top: 8px;
    font-weight: bold;
}

.report-meta-grid {
    display: grid;
    grid-template-columns: auto auto;
    gap: 20px;
    position: absolute;
    right: 0;
    bottom: 15px;
    text-align: right;
    font-size: 10pt;
    color: #888;
    font-family: sans-serif;
}

/* æ­·ç¨‹åœ–å€åŸŸ */
.chart-section {
    margin-bottom: 30px;
    height: 200px;
    width: 100%;
    border: 1px dashed #eee;
    border-radius: 8px;
    padding: 10px;
    box-sizing: border-box;
    background: #fafafa;
}

/* åˆ†æ•¸è¡¨ */
.score-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
}
.score-table th {
    text-align: left;
    color: #999;
    font-weight: normal;
    font-size: 10pt;
    padding-bottom: 5px;
    border-bottom: 1px solid #eee;
}
.score-table td {
    padding: 10px 0;
    font-size: 13pt;
    border-bottom: 1px solid #f9f9f9;
}
.score-table .total-row td {
    font-weight: bold;
    color: #5A8F7B;
    font-size: 16pt;
    border-bottom: none;
    padding-top: 15px;
}

/* è©•èªå€ */
.comment-section {
    margin-top: 20px;
}
.comment-label {
    background: #2c3e50;
    color: #fff;
    padding: 4px 12px;
    font-size: 11pt;
    display: inline-block;
    margin-bottom: 15px;
    letter-spacing: 1px;
}
.comment-content {
    line-height: 1.8;
    text-align: justify;
    font-size: 12pt;
    white-space: pre-wrap;
}

/* é å°¾ */
.report-footer {
    position: absolute;
    bottom: 14mm;
    left: 20mm; right: 20mm;
    text-align: center;
    font-size: 9pt;
    color: #ccc;
    border-top: 1px solid #f5f5f5;
    padding-top: 5px;
}
/* [v18.1.1] Modal Layering Fix */
/* ç¢ºä¿é€šç”¨å½ˆçª— (ç·¨è¼¯/åˆªé™¤ç¢ºèª) æ°¸é åœ¨ç®¡ç†åå–®ä¹‹ä¸Š */
#pop-generic-modal { z-index: 2147483650 !important; }
#pop-manage-students-modal { z-index: 2147483640 !important; }
/* ç¢ºä¿é€šç”¨å½ˆçª—çš„åº•è‰²æ›´æ·±ä¸€é»ï¼Œå€åˆ†å±¤æ¬¡ */
#pop-generic-modal .pop-modal { box-shadow: 0 25px 80px rgba(0,0,0,0.5); }

/* ========================================= */
/* === [v20.2 Fix] æ›¸ç±¤ç›®éŒ„é¡¯ç¤ºä¿®å¾© === */
/* ========================================= */
#mobile-book-overlay.active {
    display: flex !important;
    opacity: 1 !important;
    pointer-events: auto !important;
    z-index: 2147483647 !important;
}
</style>

</head>
<body>

  <div id="toast-container"></div> <!-- æ–°å¢ï¼šé€šçŸ¥å®¹å™¨ -->

  <div class="main-container">
    <div class="sticky-top-bar">
<!-- [v12.1] Header æœ€çµ‚ç‰ˆ -->
<header>
    <!-- å·¦é‚Šï¼šæ¨™é¡Œ & èº«ä»½ -->
    <div class="header-left">
        <h1>æˆ‘ä¸æƒ³åŠªåŠ›äº†</h1>
        
        <div class="auth-container">
            <span id="auth-status">æœªé€£æ¥</span>
            <div id="auth-buttons">
                <button id="login-btn" class="btn light-btn" style="padding: 2px 8px; font-size: 0.75rem;">ç™»å…¥</button>
                <button id="logout-btn" class="btn danger-btn" style="display: none; padding: 2px 8px; font-size: 0.75rem;">ç™»å‡º</button>
                <button id="sync-btn" class="btn action-btn" style="display: none; padding: 2px 8px; font-size: 0.75rem;" disabled>åŒæ­¥</button>
                 <button class="font-control-btn" onclick="toggleSettingsMenu()">âš™ï¸</button>
                
            </div>
        </div>
        
        <div id="project-header-info" class="project-header-info" style="display:none; margin-top:2px;" onclick="promptAndLoadCloudProject()">
            <span style="opacity:0.8">ğŸ“‚</span><span id="ph-class"></span><span class="ph-divider">|</span><span id="ph-topic"></span>
        </div>
    </div>

    <!-- å³é‚Šï¼šSetting æ£ -->
    <div class="header-right">
      <!-- [v17.5] æ‰‹æ©Ÿç‰ˆå°èˆªæ›¸ç±¤ (Header åµŒå…¥) -->
<button class="header-book-btn" onclick="toggleBookMenu()">ğŸ”–</button>
       
        <div id="settings-dropdown" class="settings-menu-popover" style="display: none;">
            <div class="settings-group">
                <label style="font-size:0.8rem;color:#999;display:block;margin-bottom:5px;">å­—é«”å¤§å°</label>
                <div class="font-controls-row" style="display:flex;gap:5px;">
                    <button onclick="adjustFontSize('decrease')" style="flex:1;padding:5px;">A-</button>
                    <button onclick="adjustFontSize('reset')" style="flex:1;padding:5px;">âŸ³</button>
                    <button onclick="adjustFontSize('increase')" style="flex:1;padding:5px;">A+</button>
                </div>
            </div>
            <div style="height:1px;background:#eee;margin:10px 0;"></div>
            <div class="settings-group">
                <button class="text-btn" onclick="showHotkeyHelp()" style="width:100%;text-align:left;background:none;border:none;padding:5px;cursor:pointer;">âŒ¨ï¸ éµç›¤å¿«æ·éµ</button>
            </div>
        </div>
    </div>
</header>

<!-- [v11.0] æ‡¸æµ®å°èˆªçµæ§‹ (Floating Island) -->
<nav class="page-nav-wrapper">
  
  <!-- ç¬¬ä¸€å±¤ï¼šä¸»å°èˆª (å›ºå®šä¸å‹•) -->
  <div class="main-nav">
    <button class="nav-btn active" onclick="switchMainTab('home')" data-target="home">
      <span class="nav-icon">â˜•ï¸</span> <span class="nav-text">å’–å•¡å»³</span>
    </button>
    <button class="nav-btn" onclick="switchMainTab('workspace')" data-target="workspace">
      <span class="nav-icon">ğŸ’»</span> <span class="nav-text">å·¥ä½œæ±</span>
    </button>
    <button class="nav-btn" onclick="switchMainTab('ailab')" data-target="ailab">
      <span class="nav-icon">âœ¨</span> <span class="nav-text">AI çƒ˜ç„™å®¤</span>
    </button>
    <button class="nav-btn" onclick="switchMainTab('archives')" data-target="archives">
      <span class="nav-icon">ğŸ“‘</span> <span class="nav-text">æª”æ¡ˆå®¤</span>
    </button>
  </div>

  <!-- ç¬¬äºŒå±¤ï¼šåˆ†é æ‡¸æµ®å³¶ (Floating Sub-nav) -->
  <!-- é€™è£¡æœƒçµ•å°å®šä½ï¼Œä¸æœƒæ¨éƒä¸Šé¢ -->
  <div id="sub-nav-container" class="sub-nav-island" style="display: none;">
    
    <!-- ğŸ’» å·¥ä½œæ±ï¼šSetup -> Grading -> Journal -> Analysis -->
    <div id="sub-nav-workspace" class="sub-nav-group">
        <button id="nav-page1" class="sub-nav-btn" onclick="showPage('page1')">åŸºæœ¬è¨­å®š</button>
        <button id="nav-page2" class="sub-nav-btn" onclick="showPage('page2')">æ‰¹æ”¹ä»‹é¢</button>
        <button id="nav-page4" class="sub-nav-btn" onclick="showPage('page4')">é€²åº¦æ‰‹å¸³</button>
        <button id="nav-page5" class="sub-nav-btn" onclick="showPage('page5')">è©•èªåˆ†æ</button>
    </div>
    
    <!-- âœ¨ AI çƒ˜ç„™å®¤ -->
    <div id="sub-nav-ailab" class="sub-nav-group">
        <button id="nav-page6" class="sub-nav-btn" onclick="showPage('page6')">ç”Ÿæˆè©•èªåº«</button>
        <button id="nav-page7" class="sub-nav-btn" onclick="showPage('page7')">ç”Ÿæˆå›é¥‹</button>
    </div>

    <!-- ğŸ“‘ æª”æ¡ˆå®¤ (åŸ Page 3 & 8) -->
    <div id="sub-nav-archives" class="sub-nav-group">
        <button id="nav-page3" class="sub-nav-btn" onclick="showPage('page3')">è©•èªåº«ç®¡ç†</button>
        <button id="nav-page8" class="sub-nav-btn" onclick="showPage('page8')">ç­ç´šç®¡ç†</button>
    </div>
  </div>

</nav>

<!-- æ¼¢å ¡åŒ…å·²ç§»é™¤ ğŸ”ğŸ‘‹ -->


    </div>

    <main>


   <!-- [v10.4] Cozy Dashboard HTML -->
<div id="page-home" class="page-content active">
  <div class="overview-container">
    
    <!-- 1. å•å€™å€ -->
    <div style="text-align: center; margin-bottom: 3rem; padding-top: 2rem;">
      <h2 id="welcome-msg" style="font-size: 2rem; color: var(--accent-color); border: none; margin-bottom: 0.5rem;">
        æ—©æ™¨ï¼Œè€å¸«ã€‚
      </h2>
      <p style="color: #8c867a; font-size: 1.1rem;">
        æº–å‚™å¥½é–‹å§‹ä¸€æ¯å’–å•¡çš„æ™‚é–“äº†å—ï¼Ÿ
      </p>
    </div>

    <!-- 2. æ ¸å¿ƒæ“ä½œå€ (Quick Actions) -->
    <div style="display: flex; gap: 15px; justify-content: center; margin-bottom: 3rem; flex-wrap: wrap;">
      <button class="action-btn" onclick="startNewProjectForClass(null, null)" style="padding: 12px 24px; font-size: 1.1rem;">
        âœ¨ é–‹æ–°æ‰¹æ”¹
      </button>
      <button class="secondary-btn" onclick="showPage('page8')" style="padding: 12px 24px; font-size: 1.1rem;">
        ğŸ« ç®¡ç†ç­ç´š
      </button>
    </div>

    <!-- 3. é€²è¡Œä¸­ (On My Desk) -->
    <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.2rem; color: #5b5044; margin-bottom: 1.5rem; text-align: left; border-left: 5px solid var(--accent-color); padding-left: 15px;">
            ğŸ“‚ æ¡ˆé ­å·¥ä½œ (Active Projects)
        </h3>
        <!-- é€™è£¡æœƒç”± JS æ’å…¥ã€Œæ–‡ä»¶å¤¾ã€å¡ç‰‡ -->
        <div id="focus-task-list" class="folder-grid">
            <div class="dashboard-loading">â˜•ï¸ æ­£åœ¨æ²–æ³¡æ•¸æ“š...</div>
        </div>
    </div>

    <!-- 4. ç­ç´šæ­¸æª” (éš±è—å¼) -->
    <details style="background: transparent; border: none; box-shadow: none;">
        <summary style="justify-content: center; background: transparent; color: #999; font-size: 0.9rem;">
            æŸ¥çœ‹éå¾€æ­¸æª”
        </summary>
        <div id="class-accordion-container" style="margin-top: 1rem;"></div>
    </details>

  </div>
</div>

<!-- è‡ªå®šç¾©ç·¨è¼¯å°ˆæ¡ˆ Modal -->
<div id="pop-edit-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon">âœï¸</div>
    <h3>ç·¨è¼¯å°ˆæ¡ˆè³‡è¨Š</h3>
    <p class="pop-desc">ä¿®æ”¹å¾Œçš„è³‡æ–™å°‡åŒæ­¥è‡³é›²ç«¯ã€‚</p>
    
    <!-- éš±è—æ¬„ä½ï¼šç”¨ä¾†å­˜ ID å’Œ é¡å‹ -->
    <input type="hidden" id="edit-project-id">
    <input type="hidden" id="edit-source-type">
    <input type="hidden" id="edit-class-id"> <!-- çµ¦æ–°è³‡æ–™ç”¨ -->

    <div style="text-align:left; margin-bottom:15px;">
      <label style="font-size:0.85rem; color:#666; font-weight:bold;">å­¸å¹´ (Academic Year)</label>
      <input type="text" id="edit-year" class="pop-input" style="margin:5px 0 15px 0; width:100%; box-sizing:border-box;" placeholder="ä¾‹å¦‚ï¼š2024-2025">
      
      <label style="font-size:0.85rem; color:#666; font-weight:bold;">ç­åˆ¥ (Class Name)</label>
      <input type="text" id="edit-class" class="pop-input" style="margin:5px 0 15px 0; width:100%; box-sizing:border-box;" placeholder="ä¾‹å¦‚ï¼š6A">
      
      <label style="font-size:0.85rem; color:#666; font-weight:bold;">ä½œæ–‡é¡Œç›® (Topic)</label>
      <input type="text" id="edit-topic" class="pop-input" style="margin:5px 0 15px 0; width:100%; box-sizing:border-box;" placeholder="ä½œæ–‡é¡Œç›®">
    </div>

    <!-- ä¿®æ”¹å¾Œçš„ Footerï¼ŒåŠ å…¥ justify-content: space-between ä»¥ä¾¿å°‡åˆªé™¤æŒ‰éˆ•æ¨åˆ°å·¦é‚Š -->
    <div class="pop-footer" style="justify-content: space-between;">
      <!-- å·¦é‚Šï¼šåˆªé™¤æŒ‰éˆ• -->
      <button class="pop-btn danger-btn" onclick="deleteProject()" style="background:#ffebee; color:#c62828; border:1px solid #ffcdd2;">ğŸ—‘ï¸ åˆªé™¤</button>
      
      <!-- å³é‚Šï¼šå–æ¶ˆèˆ‡å„²å­˜ -->
      <div style="display:flex; gap:10px;">
          <button class="pop-btn pop-btn-cancel" onclick="document.getElementById('pop-edit-modal').classList.remove('active')">å–æ¶ˆ</button>
          <button class="pop-btn pop-btn-confirm" onclick="saveProjectMeta()">å„²å­˜</button>
      </div>
    </div>
  </div>
</div>

<!-- [Pro-v6.3] é€šç”¨è¼¸å…¥/ç¢ºèª Modal (å–ä»£åŸç”Ÿ prompt/confirm) -->
<div id="pop-generic-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon" id="pop-generic-icon">âœ¨</div>
    <h3 id="pop-generic-title">æ¨™é¡Œ</h3>
    <p class="pop-desc" id="pop-generic-desc">æè¿°æ–‡å­—</p>
    
    <!-- è¼¸å…¥æ¡†å®¹å™¨ (é è¨­éš±è—) -->
    <div id="pop-generic-input-container" style="display:none; margin-bottom:20px;">
        <input type="text" id="pop-generic-input" class="pop-input">
    </div>

    <div class="pop-footer">
      <button class="pop-btn pop-btn-cancel" id="pop-generic-cancel">å–æ¶ˆ</button>
      <button class="pop-btn pop-btn-confirm" id="pop-generic-confirm">ç¢ºå®š</button>
    </div>
  </div>
</div>

<div id="page1" class="page-content">
 <div class="section-box">
    <h2>æ­¥é©Ÿä¸€ï¼šè¨­å®šä½œæ¥­è³‡è¨Š</h2>

    <!-- [v16.0] åªä¿ç•™é¡Œç›®èˆ‡ç­ç´šï¼Œç§»é™¤æ‰‹å‹•æ¨¡å¼ -->
    <div class="input-group" style="margin-bottom: 1.5rem;">
        <label for="topic">ä½œæ–‡é¡Œç›®</label>
        <input type="text" id="topic" placeholder="ä¾‹å¦‚ï¼šè¨˜ä¸€æ¬¡é›£å¿˜çš„ç¶“æ­·">
    </div>

    <div id="setup-registry-panel">
        <div class="input-group">
            <label>é¸æ“‡ç­ç´š</label>
            <select id="setup-class-select" onchange="handleClassSelectChange()">
                <option value="">(è«‹å…ˆç™»å…¥ä»¥è®€å–ç­ç´š)</option>
            </select>
            <div style="font-size: 0.85rem; color: #888; margin-top: 8px;">
                ğŸ’¡ æ‰¾ä¸åˆ°ç­ç´šï¼Ÿè«‹å…ˆå‰å¾€ <a href="javascript:void(0)" onclick="showPage('page8')" style="font-weight:bold; color:var(--accent-color);">ç­ç´šç®¡ç†</a> å»ºç«‹ã€‚
            </div>
        </div>

        <div id="setup-student-area" style="display:none; margin-top: 1.5rem;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
                <label style="margin:0;">å‹¾é¸å‡ºå¸­å­¸ç”Ÿ</label>
                <div style="font-size:0.9rem;">
                    <a href="javascript:void(0)" onclick="toggleAllSetupStudents(true)" style="color:var(--accent-color);">å…¨é¸</a> |
                    <a href="javascript:void(0)" onclick="toggleAllSetupStudents(false)" style="color:#c86a5a;">å…¨ä¸é¸</a>
                </div>
            </div>
            <div id="setup-student-checklist" class="student-checklist-grid">
                <!-- JS æœƒåœ¨é€™è£¡ç”¢ç”Ÿå­¸ç”Ÿå¡ç‰‡ -->
            </div>
        </div>
    </div>
</div>


  <div class="section-box">
    <h2>æ­¥é©ŸäºŒï¼šé–‹å§‹æ‰¹æ”¹</h2>
    <p style="font-size:0.9rem;color:#777;">è¨­å®šå¥½åå–®å¾Œï¼Œé¸æ“‡è¼‰å…¥æ–¹å¼ï¼š</p>
    
    <details class="io-details" open>
        <summary><h3>é¸é … Aï¼šä½¿ç”¨é è¨­ç½é ­è©•èª</h3></summary>
        <div class="io-details-content">
            <p>è«‹é¸æ“‡æ–‡ç« é¡å‹ï¼š</p>
            <div id="genre-selection" class="checkbox-group">
                <label><input type="checkbox" name="genre" value="narrative"> è¨˜æ•˜</label>
                <label><input type="checkbox" name="genre" value="lyrical"> æŠ’æƒ…</label>
                <label><input type="checkbox" name="genre" value="descriptive"> æå¯«</label>
                <label><input type="checkbox" name="genre" value="argumentative"> è­°è«–</label>
            </div>
            <div class="btn-group" style="margin-top: 1rem;">
                <button class="action-btn" onclick="startGradingWithSetup('default')">ç¢ºå®šä¸¦é–‹å§‹</button>
            </div>
        </div>
    </details>

    <details class="io-details">
        <summary><h3>é¸é … Bï¼šåƒ…è¨­å®šåå–® (æ‰‹å‹•å»ºç«‹è©•èª)</h3></summary>
        <div class="io-details-content">
            <button class="light-btn" onclick="startGradingWithSetup('manual')">åƒ…ç¢ºèªåå–®ï¼Œè·³è‡³æ‰‹å‹•ä¿®è¨‚</button>
        </div>
    </details>
  </div>
</div>

      <!-- ==================== ç¬¬äºŒé ï¼šæ‰¹æ”¹é  (æ–°) ==================== -->
      <div id="page2" class="page-content">
        <div class="grading-page-grid">
            
           <!-- ==================== Page 2 å­¸ç”Ÿé¸æ“‡å€ (ä¿®å¾©ç‰ˆ) ==================== -->
<div id="grading-section-student" class="section-box">
    <h2>ä¸€ã€é¸æ“‡å­¸ç”Ÿ</h2>
    <!-- [Pro-v9.8] å¿«é€Ÿåˆ‡æ›ä½œæ¥­ (Smart Switcher) -->
    <!-- [v11.8] Page 2 å°ˆç”¨é¡Œç›®æ¬„ (èˆ‡ Page 1 åŒæ­¥) -->
<div class="input-group" style="margin-bottom: 1rem; border-bottom: 1px dashed #ddd; padding-bottom: 1rem;">
    <label for="page2-topic-display" style="color:#5A8F7B;">ä½œæ–‡é¡Œç›®</label>
   <!-- [v19.0] é¡Œç›®é–å®š (Read-only) -->
<input type="text" id="page2-topic-display" 
       style="font-size: 1.2rem; font-weight: bold; color: #555; border: 1px solid #e0e0e0; background-color: #f4f4f4; cursor: not-allowed;" 
       placeholder="æœªè¨­å®šé¡Œç›®" readonly>
      
</div>
    
    
    
    <!-- ğŸ›‘ é—œéµä¿®å¾©ï¼šé€™å…©å€‹ ID å¿…é ˆå­˜åœ¨ï¼ŒPage 1 æ‰èƒ½å‚³è³‡æ–™éä¾† -->
    <input type="hidden" id="student-class">
    <div class="input-group">
        <label for="student-names" style="color:#999; font-size:0.9rem;">
            å­¸ç”Ÿåå–®æ•¸æ“š (ç³»çµ±è‡ªå‹•å¡«å¯«ï¼Œè«‹å‹¿æ‰‹å‹•ä¿®æ”¹)
        </label>
        <!-- ID å¿…é ˆæ˜¯ student-names -->
        <textarea id="student-names" rows="3" readonly style="background:#eee; color:#555;" placeholder="ç­‰å¾…æ•¸æ“šè¼‰å…¥..."></textarea>
    </div>
    <!-- ğŸ›‘ ä¿®å¾©çµæŸ -->

    <!-- ä¸‹é¢æ˜¯æ“ä½œå€ -->
    <div class="btn-group" style="margin-bottom: 1rem;">
        <!-- ä¿ç•™ Excel åŒ¯å…¥åŠŸèƒ½çµ¦ Page 2 ç›´æ¥ä½¿ç”¨ -->
        <label class="light-btn brown" for="import-student-list" style="cursor: pointer;">åŒ¯å…¥åå–® (Excel)</label>
        <input type="file" id="import-student-list" accept=".xlsx, .xls" style="display:none;">
        <!-- [v19.2] å¿«é€Ÿç­ç´šç®¡ç†æŒ‰éˆ• -->
<button class="light-btn" onclick="showPage('page8')" style="margin-left: 5px;">
    ğŸ« ç®¡ç†ç­ç´š
</button>
    </div>

    <div class="input-group">
        <label for="student-select">ç•¶å‰æ‰¹æ”¹å­¸ç”Ÿ</label>
        <select id="student-select" style="font-size:1.1rem; padding:10px; border:2px solid var(--accent-color);">
            <option value="">(å°šæœªè¼‰å…¥åå–®)</option>
        </select>
    </div>
    
    <div class="btn-group">
        <button class="secondary-btn" onclick="navigateToStudent('prev')">âª ä¸Šä¸€ä½</button>
        <button class="secondary-btn" onclick="navigateToStudent('next')">ä¸‹ä¸€ä½ â©</button>
    </div>
</div>

            <div id="grading-section-checklist" class="section-box">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                    <h2>äºŒã€è©•èªé …ç›®é¸æ“‡</h2>
                    <div class="btn-group">
                    <button class="light-btn" onclick="toggleAllDetails('checklist-container', true)">å…¨å±•</button>
                    <button class="light-btn brown" onclick="toggleAllDetails('checklist-container', false)">å…¨æ”¶</button>
                    </div>
                </div>
                <div id="checklist-container">
                    <div class="empty-state-message">è«‹å…ˆåœ¨ã€ŒåŸºæœ¬è¨­å®šã€é é¸æ“‡æˆ–å»ºç«‹è©•èªåº«ã€‚</div>
                </div>
            </div>

            <div id="grading-section-typo-score" class="section-box">
                <h2>ä¸‰ã€éŒ¯åˆ¥å­—åŠè©•åˆ†</h2>
                <details class="sub-section-card">
                    <summary><h3>éŒ¯åˆ¥å­—è¨˜éŒ„èˆ‡å¸¸è¦‹åº«</h3></summary>
                    <div class="sub-section-card-content">
                        <div id="typo-module" style="display:flex; flex-wrap:wrap; gap:0.75rem; align-items:flex-end;">
                            <div class="input-group" style="flex:1; min-width:140px; margin-bottom:0;">
                            <label for="typo-wrong">éŒ¯å­—</label>
                            <input type="text" id="typo-wrong">
                            </div>
                            <div class="input-group" style="flex:1; min-width:140px; margin-bottom:0;">
                            <label for="typo-correct">æ­£å­—</label>
                            <input type="text" id="typo-correct">
                            </div>
                            <button class="action-btn" onclick="addTypo()">æ–°å¢</button>
                            <button class="secondary-btn" onclick="saveTypoToCommon()">å­˜å¸¸è¦‹</button>
                        </div>
                        <ul id="typo-list" style="list-style:none; padding:0; margin-top:0.75rem;"></ul>
                        <div class="typo-saved-box">
                            <h3 class="io-box-title">å¸¸è¦‹éŒ¯åˆ¥å­—åº«</h3>
                            <ul id="typo-saved-list" class="typo-saved-list"></ul>
                        </div>
                    </div>
                </details>

                <details open class="sub-section-card">
                    <summary><h3>ä½œæ–‡è©•åˆ† (1-10åˆ†)</h3></summary>
                    <div class="sub-section-card-content">
                        <p style="font-size:0.9em; color:#888; margin-top:-0.7rem;">ç¸½åˆ† = (å…§å®¹Ã—4)+(è¡¨é”Ã—3)+(çµæ§‹Ã—2)+(æ¨™é»Ã—1)+éŒ¯åˆ¥å­—åˆ†</p>
                        <div class="score-main-grid">
                            <div class="input-group"><label for="score-content">å…§å®¹</label><input type="number" id="score-content"></div>
                            <div class="input-group"><label for="score-expression">è¡¨é”</label><input type="number" id="score-expression"></div>
                            <div class="input-group"><label for="score-structure">çµæ§‹</label><input type="number" id="score-structure"></div>
                            <div class="input-group"><label for="score-punctuation">æ¨™é»</label><input type="number" id="score-punctuation"></div>
                            <div class="input-group"><label for="score-typos">éŒ¯åˆ¥å­— (åŠ /æ¸›)</label><input type="number" id="score-typos"></div>
                        </div>
                        <div class="score-total-box" style="margin-top: 1rem;">
                            <div class="input-group"><label for="score-total">ç¸½åˆ†</label><input type="number" id="score-total" readonly></div>
                        </div>
                    </div>
                </details>
            </div>

            <div id="grading-section-feedback" class="section-box">
                <h2>å››ã€å­¸ç”Ÿè©•èª</h2>
                <div class="input-group">
                    <label for="unique-comment">ç‰¹åˆ¥ç•™è¨€ï¼ˆåªçµ¦æ­¤å­¸ç”Ÿï¼‰</label>
                    <textarea id="unique-comment" rows="4" placeholder="ä¾‹å¦‚ï¼šæœ¬æ¬¡ä½œæ–‡ç«‹æ„æ·±åˆ»ï¼Œèƒ½çœŸèª è¡¨é”å€‹äººæ„Ÿå—ã€‚"></textarea>
                </div>
                <div class="panel" style="margin-top: 1rem;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <h3>å­¸ç”Ÿç‰ˆæœ¬ï¼ˆé»åˆ—å¼ï¼‰</h3>
                       <div class="panel-actions">
    <!-- [v19.0] æ–°å¢ï¼šPDF é è¦½æŒ‰éˆ• (ç´«è‰²) -->
    <button class="action-btn" onclick="printReport('single')" style="background:#7986cb; border:none; margin-right:5px;" title="ç”Ÿæˆç²¾ç¾ A4 å ±å‘Š">
        ğŸ–¨ï¸ é è¦½ PDF
    </button>
    <button class="action-btn" onclick="copyOutput('student-report-output', this)">è¤‡è£½</button>
</div>
                    </div>
                    <textarea id="student-report-output" placeholder="æ­¤è™•è‡ªå‹•ç”Ÿæˆå­¸ç”Ÿç‰ˆæœ¬..." oninput="handleManualEdit('student')"></textarea>
                </div>
                <div class="panel" style="margin-top: 1rem;">
                    <details>
                        <summary><h3>å®Œæ•´ç‰ˆæœ¬ï¼ˆæ®µè½å¼ï¼Œé è¨­éš±è—ï¼‰</h3></summary>
                        <div class="panel-content-wrapper">
                        <div class="panel-actions" style="justify-content: flex-end;">
                            <button class="action-btn" onclick="copyOutput('full-output', this)">è¤‡è£½</button>
                        </div>
                        <textarea id="full-output" placeholder="æ­¤è™•è‡ªå‹•ç”Ÿæˆå®Œæ•´ç‰ˆæœ¬..." oninput="handleManualEdit('full')"></textarea>
                        </div>
                    </details>
                </div>
            </div>

           <!-- [Pro-v9.4-FunctionalFix] å–®ä¸€åŒæ­¥æŒ‰éˆ• -->
<!-- [Pro-v9.4-FunctionalFix] å–®ä¸€åŒæ­¥æŒ‰éˆ• (å·²ç§»é™¤æ¸…ç©ºæŒ‰éˆ•) -->
<div class="btn-group" style="justify-content: center; gap: 15px;">
    <button class="action-btn" onclick="saveCurrentStudentData('cloud')" title="å„²å­˜ä¸¦åŒæ­¥è‡³é›²ç«¯è³‡æ–™åº«">
        â˜ï¸ åŒæ­¥ä¸Šé›²
    </button>
</div>

            <!-- æ–°å¢çš„ç©ºç™½å€åŸŸï¼Œç”¨ä½œé åº•ç·©è¡ï¼Œé˜²æ­¢æ‡¸æµ®å°è¦½åˆ—ï¼ˆå°¤å…¶åœ¨æ‰‹æ©Ÿç‰ˆï¼‰é®æ“‹ä¸Šæ–¹çš„å„²å­˜æŒ‰éˆ• -->
            <div style="height: 8rem;"></div>

        </div>
      </div>

      <!-- ==================== ç¬¬ä¸‰é ï¼šè©•èªç¸½è¦½èˆ‡ä¿®è¨‚ (åŸ page 2) ==================== -->
      <div id="page3" class="page-content">
        <div class="overview-container">
          <h2>è©•èªç¸½è¦½èˆ‡ä¿®è¨‚</h2>
          
          <details id="add-critique-section">
            <summary>æ–°å¢è©•èªé …ç›®</summary>
            <div class="add-critique-form">
              <div class="add-critique-grid">
                <div class="input-group">
                  <label for="new-critique-title">è©•èªæ¨™é¡Œ*</label>
                  <input type="text" id="new-critique-title" placeholder="ä¾‹å¦‚ï¼šäººç‰©å½¢è±¡é®®æ˜">
                </div>
                <div class="input-group">
                  <label>è©•èªé¡å‹*</label>
                  <div class="radio-group">
                    <label><input type="radio" name="new-critique-type" value="excellent" checked> å„ªé»</label>
                    <label><input type="radio" name="new-critique-type" value="problem"> å¾…æ”¹é€²</label>
                  </div>
                </div>
                <div class="input-group">
                  <label for="new-critique-category-select">ç¯„ç–‡åˆ†é¡*</label>
                  <select id="new-critique-category-select"></select>
                </div>
                <div class="input-group" id="new-critique-category-new-wrapper" style="display:none;">
                  <label for="new-critique-category-new">æ–°åˆ†é¡åç¨±*</label>
                  <input type="text" id="new-critique-category-new" placeholder="è«‹è¼¸å…¥æ–°çš„åˆ†é¡åç¨±">
                </div>
              </div>
              
              <div id="new-critique-fields">
                <div class="input-group" data-type-scope="excellent">
                  <label>å„ªé»ç¸½çµ (å¯ç”¨ [é¸é …1], [é¸é …2]..)</label>
                  <textarea data-field="strengthSummary" placeholder="å°å„ªé»çš„æ¦‚æ‹¬æ€§æè¿°"></textarea>
                </div>
                <div class="input-group" data-type-scope="problem" style="display:none;">
                  <label>å•é¡Œ (å¯ç”¨ [é¸é …1], [é¸é …2]..)</label>
                  <textarea data-field="problemCore" placeholder="å°å•é¡Œæ ¸å¿ƒçš„æ¦‚æ‹¬æ€§æè¿°"></textarea>
                </div>
                <div class="input-group" data-type-scope="problem" style="display:none;">
                  <label>å®œ (å¯ç”¨ [é¸é …1], [é¸é …2]..)</label>
                  <textarea data-field="suggestion" placeholder="æ”¹å–„å»ºè­°"></textarea>
                </div>
                <div class="input-group">
                  <label>ä¾‹å­ï¼ˆæ¯è¡Œä¸€æ¢ï¼‰</label>
                  <textarea data-field="example" placeholder="å…·é«”ä¾‹å­ï¼Œç”¨ä»¥èªªæ˜è§€é»"></textarea>
                </div>
                <div class="input-group">
                  <label>ä¸‹æ‹‰é¸é …çš„æè¿°æ–‡å­— (ç”¨ | åˆ†éš”å¤šå€‹)</label>
                  <textarea data-field="optionsLabel" placeholder="ä¾‹å¦‚ï¼šå›°é›£æƒ…ç¯€|æå¯«è§’åº¦"></textarea>
                </div>
                <div class="input-group">
                  <label>ä¸‹æ‹‰é¸é … (æ¯è¡Œä¸€é …ï¼Œç”¨ | åˆ†éš”å¤šçµ„)</label>
                  <textarea data-field="options" placeholder="å¤©æ°£çªè®Š&#10;é«”åŠ›é€æ”¯&#10;å…¶ä»–&#10;|&#10;æ­£é¢&#10;å´é¢"></textarea>
                </div>
              </div>

              <button class="action-btn" onclick="addNewCritique()">æ–°å¢é …ç›®</button>
            </div>
          </details>

          <p style="margin-top:1.5rem;">æ­¤é ç‚ºè©•èªåº«çš„ä¾†æºã€‚æ‚¨å¯åœ¨æ­¤è™•ç·¨è¼¯ã€æ–°å¢æˆ–åˆªé™¤è©•èªé …ç›®ã€‚æ‰€æœ‰ä¿®æ”¹å°‡è‡ªå‹•ä¿å­˜è‡³é›²ç«¯ï¼ˆéœ€ç™»å…¥ï¼‰ã€‚</p>

          <details class="io-details">
            <summary><h3>è©•èªåº«ç®¡ç† (å°å…¥/å°å‡º/é‡è¨­)</h3></summary>
            <div class="io-details-content">
                <div class="btn-group">
                    <button class="action-btn" onclick="downloadCritiqueTemplate()">ä¸‹è¼‰ç¯„æœ¬(Excel)</button>
                    <button class="action-btn" onclick="exportCritiquesToExcel()">å°å‡ºè©•èªåº«(Excel)</button>
                    <label class="action-btn" for="import-critique-excel" style="cursor:pointer;">å°å…¥è©•èªåº«(Excel)</label>
                    <input type="file" id="import-critique-excel" accept=".xlsx, .xls, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="display:none;"/>
                </div>
                <div class="btn-group">
                    <button class="secondary-btn" onclick="exportCritiquesToJSON()">å°å‡ºè©•èªåº«(JSON)</button>
                    <label class="secondary-btn" for="import-critique-json" style="cursor:pointer;">å°å…¥è©•èªåº«(JSON)</label>
                    <input type="file" id="import-critique-json" accept=".json" style="display:none;"/>
                </div>
                <!-- æ–°å¢ï¼šé™„åŠ é è¨­è©•èª (Append) -->
                <div class="btn-group" style="margin-top: 1rem; border-top: 1px dashed #ddd; padding-top: 1rem;">
                    <button class="action-btn" style="background:#7986cb;" onclick="appendPresetsMenu()">â• é™„åŠ é è¨­è©•èª (ä¸è¦†è“‹)</button>
                </div>
                 <div class="btn-group" style="margin-top: 1rem;">
                    <button class="danger-btn" onclick="confirmUI('ç¢ºå®šè¦é‡è¨­ç‚ºç¨‹å¼å…§å»ºçš„é è¨­è©•èªå—ï¼Ÿé€™æœƒè¦†è“‹æ‚¨ç•¶å‰çš„è©•èªåº«ã€‚', resetToDefaultCritiques)">é‡è¨­ç‚ºç¨‹å¼é è¨­è©•èª</button>
                </div>
            </div>
          </details>

          <div id="overview-controls" class="btn-group" style="margin-top: 1.5rem; margin-bottom: 1rem;">
            <button class="light-btn" onclick="toggleAllDetails('overview-list', true)">å…¨éƒ¨å±•é–‹</button>
            <button class="light-btn brown" onclick="toggleAllDetails('overview-list', false)">å…¨éƒ¨æ”¶åˆ</button>
          </div>
          <div id="overview-list" class="overview-panel"></div>
        </div>
      </div>

      <!-- ==================== ç¬¬å››é ï¼šå­¸ç”Ÿç¸½è¦½ (åŸ page 3) ==================== -->
      <div id="page4" class="page-content">
        <div class="overview-container">
          <div class="page-header">
            <h2>å­¸ç”Ÿè©•èªè¨˜éŒ„ç¸½è¦½</h2>
            <div class="btn-group">
                <!-- [v19.0] æ–°å¢ï¼šå…¨ç­åˆ—å°æŒ‰éˆ• -->
<button class="action-btn" onclick="printReport('batch')" style="background:#7986cb; border:none;">
    ğŸ–¨ï¸ åˆ—å°å…¨ç­ PDF
</button>
              <button class="action-btn" onclick="exportOverviewToExcel()">ğŸ“Š åŒ¯å‡ºç‚º Excel</button>
              <button class="secondary-btn" onclick="exportOverviewToWord()">ğŸ“„ åŒ¯å‡ºå­¸ç”Ÿç‰ˆ Word</button>
              <button class="light-btn brown" onclick="exportProgressToExcel()">ğŸ“Š åŒ¯å‡ºé€²åº¦</button>
              <label class="light-btn" for="import-progress-excel" style="cursor:pointer;">ğŸ“‚ åŒ¯å…¥é€²åº¦</label>
              <input type="file" id="import-progress-excel" accept=".xlsx, .xls, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="display:none;">
            </div>
          </div>
          <h3 id="overview-class-display"></h3>
          <!-- åˆªé™¤èˆŠçš„ divï¼Œæ›æˆé€™å€‹ï¼š -->
<div id="literary-progress" class="literary-progress-box">
  <div class="literary-progress-header">
    <div class="progress-message" id="progress-text"></div>
    <div class="progress-stats" id="progress-numbers"></div>
  </div>
  <div class="progress-track">
    <div class="progress-fill" id="progress-bar"></div>
  </div>
</div>

<div id="student-overview-table-wrapper">
              <table id="student-overview-table">
                  <thead>
                      <tr>
                          <th>å­¸è™Ÿ</th>
                          <th>å§“å</th>
                          <th>å…§å®¹</th>
                          <th>è¡¨é”</th>
                          <th>çµæ§‹</th>
                          <th>æ¨™é»</th>
                          <th>éŒ¯åˆ¥å­—</th>
                          <th>ç¸½åˆ†</th>
                          <th>å­¸ç”Ÿç‰ˆè©•èª</th>
                   
                      </tr>
                  </thead>
                  <tbody>
                      <!-- å­¸ç”Ÿè³‡æ–™å°‡ç”± JavaScript å‹•æ…‹å¡«å…¥ -->
                  </tbody>
              </table>
          </div>
        </div>
      </div>

      <!-- ==================== ç¬¬äº”é ï¼šè©•èªåˆ†æ (åŸ page 4) ==================== -->
      <div id="page5" class="page-content">
  <div class="overview-container">
    <div class="page-header">
      <h2>è©•èªåˆ†æï¼ˆå…¨ç­æ¦‚æ³ï¼‰</h2>
      <div class="btn-group">
        <button class="action-btn" onclick="exportAnalysisToExcel()">ğŸ“Š åŒ¯å‡ºåˆ†æ Excel</button>
        <button class="secondary-btn" onclick="exportAnalysisToWord()">ğŸ“„ åŒ¯å‡ºåˆ†æ Word</button>
      </div>
    </div>
    <p style="font-size:0.9rem;color:#777;">
      é€éè¦–è¦ºåŒ–åœ–è¡¨ï¼Œå¿«é€ŸæŒæ¡å…¨ç­çš„å¼·å¼±é …åˆ†ä½ˆåŠå¸¸è¦‹å•é¡Œã€‚
    </p>
    
    <!-- æ–°å¢ï¼šåœ–è¡¨å€åŸŸ -->
    <div class="analysis-grid" style="margin-bottom: 2rem;">
      <div class="analysis-card">
        <h3>ğŸ“Š èƒ½åŠ›åˆ†ä½ˆé›·é”åœ–</h3>
        <div style="position: relative; height: 300px; width: 100%;">
            <canvas id="scoreChartCanvas"></canvas>
        </div>
      </div>
      <div class="analysis-card">
        <h3>ğŸ”¥ å¸¸è¦‹è©•èª Top 5</h3>
        <div style="position: relative; height: 300px; width: 100%;">
            <canvas id="critiqueChartCanvas"></canvas>
        </div>
      </div>
    </div>

    <!-- åŸæœ‰çš„è¡¨æ ¼å€åŸŸ (ä¿ç•™ä½œç‚ºè©³ç´°æ•¸æ“šåƒè€ƒ) -->
    <div class="analysis-grid">
      <div class="analysis-card">
        <h3>è©³ç´°åˆ†æ•¸æ•¸æ“š</h3>
        <div id="analysis-score-summary"></div>
      </div>
      <div class="analysis-card">
        <h3>è©³ç´°è©•èªçµ±è¨ˆ</h3>
        <div id="analysis-top-critique"></div>
      </div>
    </div>
  </div>
</div>

      <!-- ==================== ç¬¬å…­é ï¼šAI è©•èªåº«ç”Ÿæˆ (åŸ page 5) ==================== -->
<div id="page6" class="page-content">
    <div class="overview-container">
        <h2>âœ¨ AI çƒ˜ç„™å®¤ï¼šç”Ÿæˆè©•èªåº«</h2>
        <div class="cozy-hint">
            é€™è£å°±åƒæ‚¨çš„çƒ˜ç„™å»šæˆ¿ã€‚å‘Šè¨´ AI æ‚¨æƒ³ã€Œæ–™ç†ã€ä»€éº¼æ¨£çš„è©•èªï¼Œå®ƒæœƒç‚ºæ‚¨æº–å‚™å¥½æ–°é®®çš„é£Ÿæã€‚<br>
            (ç„¡éœ€æ“”å¿ƒæŠ€è¡“ä»£ç¢¼ï¼Œåªéœ€ç°¡å–®çš„è¤‡è£½èˆ‡è²¼ä¸Šã€‚)
        </div>

        <div class="ai-page-grid">
            <!-- å·¦æ¬„ï¼šé»é¤å€ (è¨­å®š) -->
            <div class="ai-magic-card">
                <div class="ai-step-title">1. è¨­å®šå£å‘³</div>
                
                <div class="input-group">
                    <label>å­¸ç”Ÿç¨‹åº¦</label>
                    <select id="ai-student-level">
                        <option value="junior">åˆä¸­ (åŸºç¤ç©©å›º)</option>
                        <option value="intermediate" selected>é«˜ä¸­ (æŠ€å·§æå‡)</option>
                        <option value="advanced">æ–‡æ†‘è©¦è¡åˆº (DSE)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label>ä½œæ–‡é¡Œç›®</label>
                    <input type="text" id="ai-topic" placeholder="ä¾‹å¦‚ï¼šä¸€æ¬¡é›£å¿˜çš„ç¶“æ­·">
                </div>

                <div class="input-group">
                    <label>è©•èªé‡é»</label>
                    <select id="ai-focus">
                        <option value="balanced">å¹³è¡¡ (å„ªé»/ç¼ºé»å„åŠ)</option>
                        <option value="encourage">æš–å¿ƒé¼“å‹µ (å¤šè®šè³)</option>
                        <option value="improve">åš´æ ¼æé» (å¤šå»ºè­°)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>ç‰¹åˆ¥é—œæ³¨é» (å¯é¸)</label>
                    <textarea id="ai-highlights" rows="2" placeholder="ä¾‹å¦‚ï¼šæƒ³é‡å°ã€Œäººç‰©æå¯«ã€çµ¦æ›´å¤šå»ºè­°..."></textarea>
                </div>
            </div>

            <!-- å³æ¬„ï¼šå‡ºé¤å€ (æ“ä½œ) -->
            <div class="ai-magic-card">
                <div class="ai-step-title">2. ç²å–èˆ‡æ‡‰ç”¨</div>
                
                <p style="font-size:0.9rem; color:#666; margin-bottom:15px;">
                    æº–å‚™å¥½å¾Œï¼ŒæŒ‰ä¸‹æ–¹æŒ‰éˆ•è¤‡è£½æŒ‡ä»¤ï¼Œç„¶å¾Œè²¼çµ¦æ‚¨çš„ AI åŠ©æ‰‹ (ChatGPT/Poe)ã€‚
                </p>

                <button class="action-btn" onclick="generateAndCopyPrompt()" style="width:100%; padding:15px; font-size:1.1rem; margin-bottom:20px;">
                    ğŸ“‹ è¤‡è£½ AI æŒ‡ä»¤ (Copy Prompt)
                </button>

                <!-- éš±è—çš„ Prompt é è¦½ (åªæœ‰æƒ³ Check å˜…äººå…ˆé–‹) -->
                <details class="tech-details">
                    <summary>âš™ï¸ æŸ¥çœ‹æŒ‡ä»¤åŸæ–‡ (Technical View)</summary>
                    <textarea id="ai-prompt-preview" class="tech-textarea" rows="5" readonly></textarea>
                </details>

                <div style="margin: 30px 0 15px 0; border-top: 1px solid #eee;"></div>

                <div class="ai-step-title">3. æ¥æ”¶æˆå“</div>
                <p style="font-size:0.9rem; color:#666;">
                    å°‡ AI å›è¦†çš„å…§å®¹ (ä»¥ <code>[</code> é–‹é ­ <code>]</code> çµå°¾çš„æ–‡å­—) è²¼åœ¨ä¸‹æ–¹ï¼š
                </p>
                <textarea id="ai-json-input" class="pop-input" rows="4" placeholder="åœ¨æ­¤è²¼ä¸Š AI çš„å›ä¿¡..."></textarea>
                
                <button class="secondary-btn" onclick="applyAIJson()" style="width:100%; margin-top:10px;">
                    ğŸ“¥ å„²å­˜åˆ°æˆ‘çš„è©•èªåº«
                </button>
            </div>
        </div>
    </div>
</div>
      <!-- ==================== ç¬¬ä¸ƒé ï¼šAI ç”Ÿæˆå›é¥‹ (åŸ page 6) ==================== -->
 <div id="page7" class="page-content">
    <div class="overview-container">
        <h2>ğŸ“ AI çƒ˜ç„™å®¤ï¼šç”Ÿæˆæ•™å­¸å›é¥‹</h2>
        <div class="cozy-hint">
            é€™è£¡å¯ä»¥å°‡å…¨ç­çš„è¡¨ç¾ï¼Œè½‰åŒ–ç‚ºä¸€ä»½æº«æš–è€Œå°ˆæ¥­çš„è·Ÿé€²æ–‡ä»¶ã€‚<br>
            æˆ‘å€‘æœƒç‚ºæ‚¨ç”Ÿæˆè€å¸«å°ˆç”¨çš„ã€Œæ•™å­¸è©³æ¡ˆã€å’Œçµ¦å­¸ç”Ÿçš„ã€Œé¼“å‹µå–®å¼µã€ã€‚
        </div>

        <div class="ai-page-grid">
            <!-- å·¦æ¬„ï¼šææ–™æº–å‚™ -->
            <div class="ai-magic-card">
                <div class="ai-step-title">1. é¸æ“‡ææ–™ (åˆ†æä¾†æº)</div>
                <div class="checkbox-group" style="display:flex; flex-direction:column; gap:8px;">
                    <label><input type="checkbox" id="ai-source-excel" checked> ğŸ“Š å…¨ç­è©•èªæ•¸æ“š (Excel)</label>
                    <label><input type="checkbox" id="ai-source-stats" checked> ğŸ“ˆ åˆ†æ•¸åˆ†ä½ˆèˆ‡çµ±è¨ˆ</label>
                    <label><input type="checkbox" id="ai-source-basic" checked> ğŸ·ï¸ é¡Œç›®èˆ‡å¹´ç´šè³‡è¨Š</label>
                </div>

                <div style="margin-top:20px;"></div>
                <div class="ai-step-title">2. çƒ¹èª¿å…§å®¹ (è¼¸å‡ºæ¨¡çµ„)</div>
                <div class="checkbox-group" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <label><input type="checkbox" id="ai-module-overview" checked> ç¸½çµæ¦‚è¦½</label>
                    <label><input type="checkbox" id="ai-module-topic" checked> å¯©é¡Œåˆ†æ</label>
                    <label><input type="checkbox" id="ai-module-material-theme" checked> é¸æèˆ‰éš…</label>
                    <label><input type="checkbox" id="ai-module-excellent-students" checked> ä½³ä½œè¡¨æš</label>
                    <label><input type="checkbox" id="ai-module-tiers" checked> åˆ†å±¤ç¤ºä¾‹</label>
                    <label><input type="checkbox" id="ai-module-practice" checked> è·Ÿé€²ç·´ç¿’</label>
                    <label><input type="checkbox" id="ai-module-plan" checked> æ•™å­¸è¨ˆåŠƒ</label>
                </div>

                <div class="input-group" style="margin-top: 15px;">
                    <label>é¡å¤–èª¿å‘³ (æç¤º)</label>
                    <textarea id="ai-feedback-extra-hints" rows="2" placeholder="ä¾‹å¦‚ï¼šé€™ç­åŒå­¸æ¯”è¼ƒç¼ºä¹è‡ªä¿¡ï¼Œè«‹å¤šä¸€é»é¼“å‹µ..."></textarea>
                </div>
            </div>

            <!-- å³æ¬„ï¼šé–‹å§‹è£½ä½œ -->
            <div class="ai-magic-card">
                <div class="ai-step-title">3. ç”Ÿæˆèˆ‡åŒ¯å‡º</div>
                
                <!-- åŒ¯å‡º Excel æŒ‰éˆ• -->
                <button class="light-btn brown" onclick="exportStudentDataForAI()" style="width:100%; margin-bottom:15px; text-align:left; justify-content: center;">
                    ğŸ“‚ ä¸‹è¼‰æ•¸æ“š Excel (ä¾›ä¸Šå‚³çµ¦ AI)
                </button>

                <button class="action-btn" onclick="generateFeedbackPromptAndCopy()" style="width:100%; padding:15px; font-size:1.1rem;">
                    âœ¨ ç”Ÿæˆä¸¦è¤‡è£½æŒ‡ä»¤ (Copy)
                </button>

                <!-- éš±è—ç´°ç¯€ -->
                <details class="tech-details">
                    <summary>âš™ï¸ æŸ¥çœ‹æŒ‡ä»¤åŸæ–‡</summary>
                    <textarea id="ai-feedback-prompt-preview" class="tech-textarea" rows="5" readonly></textarea>
                </details>

                <div style="margin: 25px 0 15px 0; border-top: 1px solid #eee;"></div>

                <div class="ai-step-title">4. é ˜å–æ–‡ä»¶</div>
                <textarea id="ai-feedback-json-input" class="pop-input" rows="4" placeholder="åœ¨æ­¤è²¼ä¸Š AI å›è¦†çš„ JSON..."></textarea>
                
                <div style="display:flex; gap:10px; margin-top:10px;">
                    <button class="secondary-btn" onclick="generateTeacherWord()" style="flex:1;">ğŸ‘©ğŸ»â€ğŸ« è€å¸«ç‰ˆ Word</button>
                    <button class="secondary-btn" onclick="generateStudentWord()" style="flex:1;">ğŸ§‘ğŸ»â€ğŸ“ å­¸ç”Ÿç‰ˆ Word</button>
                </div>
            </div>
        </div>
    </div>
</div>

      <!-- ... ä¸Šé¢ä¿‚ Page 7 çš„ </div> çµå°¾ ... -->

<!-- âœ…âœ…âœ… åœ¨é€™è£¡è²¼ä¸Š Page 8 çš„ HTML âœ…âœ…âœ… -->
<div id="page8" class="page-content">
  <div class="overview-container">
    <div class="page-header">
      <h2>ç­ç´šç®¡ç† (The Registry)</h2>
      <div class="btn-group">
        <button class="action-btn" onclick="createNewClass()">ï¼‹ æ–°å¢ç­ç´š</button>
      </div>
    </div>
    
    <p style="font-size:0.9rem; color:#777;">
      åœ¨é€™è£¡å»ºç«‹æ‚¨çš„ç­ç´šæ¯åå–®ã€‚æ—¥å¾Œé–‹æ–°æ‰¹æ”¹æ™‚ï¼Œå¯ç›´æ¥é¸å–æ•´ç­å­¸ç”Ÿï¼Œç„¡é ˆæ¯æ¬¡åŒ¯å…¥ã€‚<br>
      <span style="color:#c86a5a;">(æ³¨æ„ï¼šæ­¤åŠŸèƒ½éœ€é€£æ¥é›²ç«¯è³‡æ–™åº«)</span>
    </p>

    <!-- ç­ç´šåˆ—è¡¨å®¹å™¨ -->
    <div id="class-management-list" class="task-list-container" style="margin-top:2rem;">
      <div class="dashboard-loading">æ­£åœ¨è®€å–ç­ç´šè³‡æ–™...</div>
    </div>
  </div>
</div>
<!-- âœ…âœ…âœ… è²¼ä¸ŠçµæŸ âœ…âœ…âœ… -->
 <!-- è‡ªå®šç¾©ç®¡ç†å­¸ç”Ÿåå–® Modal (Page 8 å°ˆç”¨ - ä¿®æ­£ç‰ˆ) -->
<div id="pop-manage-students-modal" class="pop-overlay">
  <div class="pop-modal" style="max-width: 600px;">
    <div class="pop-icon">ğŸ‘¥</div>
    <h3 id="manage-class-title">ç®¡ç†åå–®</h3>
    
    <!-- éš±è—æ¬„ä½ï¼šå­˜ä½ç¾åœ¨æ”¹ç·Šé‚Šç­ -->
    <input type="hidden" id="manage-class-id">

    <!-- å·¥å…·åˆ—ï¼šä¸‹è¼‰ç¯„æœ¬ èˆ‡ åŒ¯å…¥ -->
    <div style="display:flex; gap:10px; margin-bottom:15px; justify-content:center; flex-wrap:wrap;">
      <!-- âœ… é€™æ˜¯ Page 8 å°ˆç”¨çš„ä¸‹è¼‰æŒ‰éˆ• -->
      <button class="btn light-btn" onclick="downloadMasterListTemplate()" style="font-size:0.85rem;">
        ğŸ“¥ ä¸‹è¼‰ Excel ç¯„æœ¬
      </button>
      
      <label class="btn secondary-btn" style="font-size:0.85rem; cursor:pointer;">
        ğŸ“‚ åŒ¯å…¥ Excel
        <input type="file" id="import-master-list-file" accept=".xlsx, .xls" style="display:none;" onchange="handleMasterListImport(this)">
      </label>
    </div>

    <!-- âœ… æ‰¹é‡æ–‡å­—è¼¸å…¥å€ (ä¸å†æ‘ºç–Šï¼Œç›´æ¥é¡¯ç¤º) -->
    <div style="margin-bottom:15px; text-align:left; border:1px solid #eee; padding:10px; border-radius:8px; background:#fafafa;">
        <label style="font-size:0.85rem; font-weight:bold; color:#5A8F7B; display:block; margin-bottom:5px;">
            ğŸ“ æ‰¹é‡è²¼ä¸Š (æ¯è¡Œä¸€ä½ï¼Œä¾‹å¦‚ï¼š01 é™³å¤§æ–‡)
        </label>
        <!-- ç¢ºä¿é€™æ˜¯ textarea -->
        <textarea id="batch-student-input" rows="4" class="pop-input" style="width:100%; box-sizing:border-box; text-align:left; font-size:0.9rem;" placeholder="åœ¨æ­¤ç›´æ¥è²¼ä¸Šåå–®..."></textarea>
        <button class="action-btn" style="width:100%; margin-top:5px; padding:6px;" onclick="addBatchStudentsToMaster()">
            â¬‡ï¸ ç¢ºèªæ–°å¢åå–®
        </button>
    </div>

    <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">

    <!-- å­¸ç”Ÿåˆ—è¡¨é¡¯ç¤ºå€ -->
    <div class="pop-scroll-area" id="master-student-list" style="height: 200px; max-height: 30vh;">
      <div style="text-align:center; color:#999; padding:20px;">æ­£åœ¨è®€å–...</div>
    </div>

    <div class="pop-footer">
      <button class="pop-btn pop-btn-confirm" onclick="closeManageStudentsModal()">å®Œæˆ / é—œé–‰</button>
    </div>
  </div>
</div>


    </main>
  </div>


  <!-- è‡ªè£½ç¢ºèªå°è©±æ¡† -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" role="document">
      <div class="modal-title" id="modal-title">è«‹ç¢ºèª</div>
      <div id="modal-text" style="white-space: pre-wrap;">ç¢ºèªåŸ·è¡Œï¼Ÿ</div>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="modal-cancel">å–æ¶ˆ</button>
        <button class="btn btn-danger" id="modal-ok">ç¢ºå®š</button>
      </div>
    </div>
  </div>

  <!-- è©•èªè³‡æ–™ä¾†æº -->
  <div id="critique-data" style="display:none;">
    <!-- é è¨­è©•èªæœƒç”± JS è¼‰å…¥ -->
  </div>

  <!-- [Pro-v6.1] æ‡¸æµ®å°è¦½åˆ— (å·²ä¿®æ­£å„²å­˜æŒ‰éˆ•åˆ†æµ) -->
<nav id="floating-nav">
    <!-- å¿«é€Ÿå°èˆª -->
    <a href="#grading-section-student" class="floating-nav-btn" onclick="scrollToSection(event, 'grading-section-student')" data-tooltip="å­¸ç”Ÿ">ğŸ˜½</a>
    <a href="#grading-section-checklist" class="floating-nav-btn" onclick="scrollToSection(event, 'grading-section-checklist')" data-tooltip="è©•èªé …ç›®">âœ…</a>
    <a href="#grading-section-typo-score" class="floating-nav-btn" onclick="scrollToSection(event, 'grading-section-typo-score')" data-tooltip="éŒ¯åˆ¥å­—/è©•åˆ†">ğŸ“</a>
    <a href="#grading-section-feedback" class="floating-nav-btn" onclick="scrollToSection(event, 'grading-section-feedback')" data-tooltip="å­¸ç”Ÿè©•èª">ğŸ“„</a>
    
   

    <!-- å”¯ä¸€çš„å„²å­˜è¡Œå‹• (Unified Action) -->
    <a href="javascript:void(0)" class="floating-nav-btn" onclick="saveCurrentStudentData('cloud')" data-tooltip="â˜ï¸ å„²å­˜ä¸¦åŒæ­¥">â˜ï¸</a>
</nav>

<!-- è‡ªå®šç¾© Pop Art é¢¨æ ¼ Project Selection Modal -->
<div id="pop-project-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon">ğŸ“‚</div>
    <h3>é›²ç«¯å°ˆæ¡ˆè®€å–</h3>
    <p class="pop-desc">
      åœ¨é›²ç«¯æ‰¾åˆ°ä»¥ä¸‹å°ˆæ¡ˆã€‚<br>
      è«‹è¼¸å…¥æ•¸å­—é¸æ“‡ï¼Œæˆ–ç›´æ¥é»æ“Šåˆ—è¡¨é …ç›®ã€‚
    </p>
    
    <div class="pop-scroll-area" id="pop-project-list">
      <!-- JS æœƒå‹•æ…‹æ’å…¥å…§å®¹ -->
    </div>

    <input type="number" id="pop-project-input" class="pop-input" placeholder="è¼¸å…¥ç·¨è™Ÿ..." min="1">

   <div class="pop-footer">
      <!-- æ”¹å’—ä¸‹é¢å‘¢è¡Œæ–‡å­—ï¼Œè®Šæˆã€Œé–‹æ–°å°ˆæ¡ˆã€ -->
      <button class="pop-btn pop-btn-cancel" id="pop-project-cancel">é–‹æ–°å°ˆæ¡ˆ (ä¸è¼‰å…¥)</button>
      <button class="pop-btn pop-btn-confirm" id="pop-project-confirm">ç¢ºå®šè¼‰å…¥</button>

    </div>
  </div>
</div>


<!-- [Pro-v9.7.1] ç­ç´šç¶œåˆå ±å‘Šå½ˆçª— (UI å„ªåŒ–ç‰ˆ) -->
<div id="pop-class-report-modal" class="pop-overlay">
  <div class="pop-modal pop-modal-large">
    <h3 id="report-class-title">ç­ç´šç¶œåˆå ±å‘Š</h3>
    <p class="pop-desc" style="margin-bottom: 10px;">è«‹å‹¾é¸ä½œæ¥­ï¼Œä¸¦é¸æ“‡åŒ¯å‡ºæ¨¡å¼ã€‚</p>
    
    <input type="hidden" id="report-class-id">

    <!-- 1. ä½œæ¥­åˆ—è¡¨å€ (éœ¸ä½”ä¸»è¦ç©ºé–“) -->
    <!-- min-height: 300px ç¢ºä¿åˆ—è¡¨å¤ é•·ï¼Œç‡å¾—èˆ’æœ -->
    <div class="pop-scroll-area" id="report-project-list" style="flex-grow: 1; min-height: 300px; margin-top:0;">
      <div style="text-align:center; color:#999; padding:20px;">
        <div class="spinner"></div> è®€å–ä¸­...
      </div>
    </div>

    <!-- 2. åŒ¯å‡ºæ¨¡å¼é¸æ“‡å€ (ç·Šæ¹Šç‰ˆ) -->
    <div style="flex-shrink: 0; padding-top: 15px; border-top: 1px solid #eee;">
        <div style="font-weight:bold; color:#5A8F7B; margin-bottom:8px; text-align: left;">
            ğŸ“Š å ±å‘Šé¡å‹ï¼š
        </div>
        
        <div style="display:flex; gap: 20px; flex-wrap: wrap;">
            <!-- é¸é … A -->
            <label style="flex:1; display:flex; align-items:center; gap:10px; padding:12px; border:1px solid #ddd; border-radius:8px; cursor:pointer; background:#fdfbf7;">
                <input type="radio" name="report-mode" value="exam" checked style="accent-color:#5A8F7B; transform:scale(1.2);">
                <div>
                    <div style="font-weight:bold; color:#333;">ğŸ“„ åˆä½µå–®æ¬¡è€ƒè©¦</div>
                    <div style="font-size:0.8rem; color:#888;">(åˆ†é¡Œåˆä½µç‚ºä¸€ç¸½åˆ†)</div>
                </div>
            </label>

            <!-- é¸é … B -->
            <label style="flex:1; display:flex; align-items:center; gap:10px; padding:12px; border:1px solid #ddd; border-radius:8px; cursor:pointer; background:#fdfbf7;">
                <input type="radio" name="report-mode" value="trend" style="accent-color:#5A8F7B; transform:scale(1.2);">
                <div>
                    <div style="font-weight:bold; color:#333;">ğŸ“ˆ æ­·ç¨‹è¶¨å‹¢åˆ†æ</div>
                    <div style="font-size:0.8rem; color:#888;">(å¤šæ¬¡åˆ†æ•¸ä¸¦åˆ—èµ°å‹¢)</div>
                </div>
            </label>
        </div>
    </div>

    <!-- 3. åº•éƒ¨æŒ‰éˆ• -->
    <div class="pop-footer">
      <button class="pop-btn pop-btn-cancel" onclick="document.getElementById('pop-class-report-modal').classList.remove('active')">å–æ¶ˆ</button>
      <button class="pop-btn pop-btn-confirm" onclick="generateCombinedExcel()">ğŸ“¥ ç”Ÿæˆ Excel</button>
    </div>
  </div>
</div>

<!-- è‡ªå®šç¾©ç™»å…¥ Modal (Email + å¯†ç¢¼ + å¿˜è¨˜å¯†ç¢¼ç‰ˆ) -->
<div id="pop-login-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon">ğŸ”</div>
    <h3>å¸³æˆ¶ç™»å…¥</h3>
    <p class="pop-desc">
      è«‹ä½¿ç”¨ Email åŠå¯†ç¢¼ç™»å…¥ã€‚<br>
      <span style="font-size:0.85rem; color:#999;">(å¦‚æœªæœ‰å¸³æˆ¶ï¼Œè«‹å¡«å¥½è³‡æ–™å¾ŒæŒ‰ã€Œè¨»å†Šã€)</span>
    </p>
    
    <!-- Email è¼¸å…¥æ¡† -->
    <input type="text" id="login-email" class="pop-input" placeholder="é›»éƒµåœ°å€ (Email)" autocomplete="email" style="margin-bottom: 10px;">
    
    <!-- å¯†ç¢¼è¼¸å…¥æ¡† -->
    <input type="password" id="login-password" class="pop-input" placeholder="å¯†ç¢¼ (Password)" autocomplete="current-password">

    <!-- å¿˜è¨˜å¯†ç¢¼é€£çµ -->
    <div style="text-align: right; width: 80%; margin: -10px auto 20px auto;">
      <a href="javascript:void(0)" onclick="handleForgotPassword()" style="color: #888; font-size: 0.85rem; text-decoration: underline;">å¿˜è¨˜å¯†ç¢¼ / è¨­å®šæ–°å¯†ç¢¼ï¼Ÿ</a>
    </div>

    <div class="pop-footer" style="flex-wrap: wrap; gap: 10px; justify-content: center;">
      <button class="pop-btn pop-btn-cancel" onclick="closeLoginModal()">å–æ¶ˆ</button>
      <button class="pop-btn" style="background:#e0e0e0; color:#555;" onclick="handlePasswordAuth('signup')">è¨»å†Š</button>
      <button class="pop-btn pop-btn-confirm" onclick="handlePasswordAuth('login')">ç™»å…¥</button>
    </div>
  </div>
</div>

<!-- è‡ªå®šç¾©é‡è¨­å¯†ç¢¼ Modal -->
<div id="pop-reset-password-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon">ğŸ”</div>
    <h3>è¨­å®šæ–°å¯†ç¢¼</h3>
    <p class="pop-desc">
      æ­¡è¿å›ä¾†ï¼è«‹è¼¸å…¥æ‚¨çš„æ–°å¯†ç¢¼ã€‚<br>
      <span style="font-size:0.85rem; color:#c86a5a;">(âš ï¸ å¯†ç¢¼é•·åº¦æœ€å°‘éœ€ 6 å€‹å­—å…ƒ)</span>
    </p>
    
    <input type="password" id="new-password-input" class="pop-input" placeholder="æ–°å¯†ç¢¼ (New Password)">
    
    <div class="pop-footer">
    <!-- ç¢ºä¿ onclick æŒ‡å‘æˆ‘å€‘çš„æ–°å‡½æ•¸ -->
<button class="pop-btn pop-btn-confirm" id="confirm-reset-btn" onclick="confirmResetPassword()">ç¢ºèªä¿®æ”¹</button>
    </div>
  </div>
</div>


<!-- ... (é€™æ˜¯åŸæœ¬çš„é‡è¨­å¯†ç¢¼ Modal) ... -->
<div id="pop-reset-password-modal" class="pop-overlay">
  <!-- ... ç•¥ ... -->
    <div class="pop-footer">
    <!-- ç¢ºä¿ onclick æŒ‡å‘æˆ‘å€‘çš„æ–°å‡½æ•¸ -->
<button class="pop-btn pop-btn-confirm" id="confirm-reset-btn" onclick="confirmResetPassword()">ç¢ºèªä¿®æ”¹</button>
    </div>
  </div>
</div>

<!-- âœ…âœ…âœ… è«‹å°‡æ–°ä»£ç¢¼è²¼åœ¨é€™è£¡ (å…©è€…ä¸­é–“) âœ…âœ…âœ… -->

<!-- å­¸ç”Ÿå€‹äººæˆé•·åœ–è¡¨ Modal -->
<div id="pop-student-history-modal" class="pop-overlay">
  <div class="pop-modal" style="max-width: 600px;">
    <div class="pop-icon">ğŸ“ˆ</div>
    <h3 id="history-student-name">å­¸ç”Ÿæ­·ç¨‹</h3>
    <p class="pop-desc">è©²ç”Ÿåœ¨ä¸åŒä½œæ¥­ä¸­çš„è¡¨ç¾è¶¨å‹¢ã€‚</p>
    
    <!-- åœ–è¡¨å®¹å™¨ -->
    <div style="width: 100%; height: 300px; position: relative;">
        <canvas id="studentHistoryChart"></canvas>
    </div>

    <div class="pop-footer">
      <button class="pop-btn pop-btn-confirm" onclick="document.getElementById('pop-student-history-modal').classList.remove('active')">é—œé–‰</button>
    </div>
  </div>
</div>

<!-- âœ…âœ…âœ… è²¼ä¸ŠçµæŸ âœ…âœ…âœ… -->
<!-- ================================================= -->
<!-- [Pro-v9.9.7] ç™»å…¥ç‰† (å¼·åˆ¶ç½®é ‚ç‰ˆ) -->
<!-- ================================================= -->
<div id="login-gate" class="login-gate">
  <div class="pop-modal gate-card" style="display: none">
    
    <div style="font-size: 2.5rem; margin-bottom: 5px;">â˜•ï¸</div>
    <h2 style="color: #3d5c4f; font-size: 1.5rem; margin: 5px 0 10px 0;">æˆ‘ä¸æƒ³åŠªåŠ›äº† Pro</h2>
    <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">é¡˜æ‚¨çš„é€±æœ«ï¼Œæœ‰ä¸€æ¯ç†±å’–å•¡çš„æ™‚é–“ã€‚</p>
    
    <div class="gate-input-group">
        <label style="display:block; color:#888; font-size:0.85rem; margin-bottom:5px; text-align: left;">é›»éƒµåœ°å€ (Email)</label>
        <input type="text" id="gate-email" class="pop-input" style="margin-bottom:15px; width: 100%;">
        
        <label style="display:block; color:#888; font-size:0.85rem; margin-bottom:5px; text-align: left;">å¯†ç¢¼ (Password)</label>
        <input type="password" id="gate-password" class="pop-input" style="margin-bottom:5px; width: 100%;">
        
        <div style="text-align: right; margin-bottom: 25px;">
             <a href="javascript:void(0)" onclick="openForgotModal()" style="color:#999; font-size: 0.8rem; text-decoration:underline;">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a>
        </div>
        
        <button class="pop-btn pop-btn-confirm" 
                style="width:100%; max-width:100%; margin: 0 auto; display: block; text-align: center; padding:12px; font-size:1.1rem; box-shadow: 0 10px 20px rgba(242, 192, 55, 0.3);" 
                onclick="handleGateAuth()">
             é€²å…¥ä½ çš„æ„œæ„å·¥ä½œå’–å•¡å»³ ğŸ¥
        </button>

        <div style="margin-top: 20px; text-align: center;">
            <a href="https://forms.gle/ä½ çš„GoogleFormID" target="_blank" 
               style="color: #5A8F7B; font-weight: bold; text-decoration: none; border-bottom: 1px dashed #5A8F7B; font-size: 0.9rem; transition: all 0.2s;" 
               onmouseover="this.style.color='#3d5c4f'; this.style.borderBottomStyle='solid'" 
               onmouseout="this.style.color='#5A8F7B'; this.style.borderBottomStyle='dashed'">
                å°šæœªæŒæœ‰é€šè¡Œè­‰ï¼Ÿç”³è«‹æˆç‚ºå’–å•¡å»³å¸¸å®¢ğŸ¤
            </a>
        </div>
    </div>

    <div style="margin-top: 25px; font-size: 0.85rem; background: rgba(90,143,123,0.08); padding: 10px 15px; border-radius: 99px;">
        <a href="http://idw-lite.vercel.app" target="_blank" style="color:#555; text-decoration:none;">
            åªéœ€å–®æ¬¡æ‰¹æ”¹ï¼Ÿ <span style="color:#8d775f; font-weight:bold;">ğŸŒ± å‰å¾€è¼•é‡ç‰ˆ (Lite) è©¦ç”¨</span>
        </a>
    </div>

  </div>
</div>

<!-- [v15.0] é€²åº¦é‚„åŸæç¤º Modal -->
<div id="pop-restore-modal" class="pop-overlay">
    <div class="pop-modal">
        <div class="pop-icon">â™»ï¸</div>
        <h3>ç™¼ç¾æœªå„²å­˜çš„é€²åº¦</h3>
        <p class="pop-desc" id="restore-msg-time">
            ç³»çµ±æª¢æ¸¬åˆ°æ‚¨å‰›æ‰æ­£åœ¨æ‰¹æ”¹ä¸­ã€‚<br>
            æ˜¯å¦é‚„åŸä¸Šæ¬¡çš„ç•«é¢ï¼Ÿ
        </p>
        <div class="pop-footer">
            <button class="pop-btn pop-btn-cancel" onclick="discardAndGoHome()">ä¸é‚„åŸ (å›é¦–é )</button>
            <button class="pop-btn pop-btn-confirm" onclick="confirmRestore()">é‚„åŸä¸¦ç¹¼çºŒ</button>
        </div>
    </div>
</div>

<!-- [v18.3] é–‹æ–°æ‰¹æ”¹ç¢ºèª Modal -->
<div id="pop-setup-confirm-modal" class="pop-overlay">
    <div class="pop-modal">
        <div class="pop-icon">â˜•ï¸</div>
        <h3>é å‚™å¥½äº†å—ï¼Ÿ</h3>
        <p class="pop-desc">è«‹æ ¸å°ä»¥ä¸‹è³‡è¨Šï¼Œç¢ºå®šå¾Œå°‡ç«‹å³å»ºç«‹é›²ç«¯å°ˆæ¡ˆã€‚</p>
        
        <div style="background:#f9f9f9; padding:15px; border-radius:12px; text-align:left; margin-bottom:20px; border:1px solid #eee;">
            <div style="margin-bottom:8px;">
                <span style="color:#888; font-size:0.85rem;">ä½œæ–‡é¡Œç›®ï¼š</span><br>
                <strong id="confirm-topic-display" style="font-size:1.1rem; color:#3d5c4f;"></strong>
            </div>
            <div style="margin-bottom:8px;">
                <span style="color:#888; font-size:0.85rem;">ç­åˆ¥ï¼š</span><br>
                <strong id="confirm-class-display" style="font-size:1.1rem; color:#3d5c4f;"></strong>
            </div>
            <div>
                <span style="color:#888; font-size:0.85rem;">ä½œç­”äººæ•¸ï¼š</span><br>
                <strong id="confirm-count-display" style="font-size:1.1rem; color:#c86a5a;"></strong> 
         <div style="margin-top:12px; border-top:1px dashed #ddd; padding-top:10px;">
    <span style="color:#888; font-size:0.85rem;">å·²é¸åå–®é è¦½ï¼š</span>
    <div id="confirm-student-list" style="font-size:0.9rem; color:#555; max-height:100px; overflow-y:auto; margin-top:5px; line-height:1.5;">
        <!-- JS æœƒå¡«å…¥åå–® -->
    </div>
</div>
        


 <div class="pop-footer">
   <button class="pop-btn pop-btn-cancel" onclick="document.getElementById('pop-setup-confirm-modal').classList.remove('active')">è¿”å›ä¿®æ”¹</button>
   <button class="pop-btn pop-btn-confirm" id="btn-create-project-confirm">ç¢ºå®šå»ºç«‹</button>
 </div>
    </div>
</div>

<!-- [v19.0] åˆ—å°å°ˆç”¨å®¹å™¨ (å¹³æ™‚éš±è—) -->
<div id="print-container">
    <!-- JS æœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ .report-page -->
</div>

<!-- [v19.4] å°ˆæ¡ˆè©³æƒ… Modal (è£œå›) -->
<div id="pop-project-details-modal" class="pop-overlay">
  <div class="pop-modal">
    <div class="pop-icon">ğŸ—’</div>
    <h3>å°ˆæ¡ˆè©³æƒ…</h3>
    
    <!-- éš±è—æ¬„ä½ï¼šå„²å­˜ ID ç”¨æ–¼åˆªé™¤ -->
    <input type="hidden" id="detail-project-id">
    <input type="hidden" id="detail-project-title">

    <div style="text-align: left; margin: 15px 0; font-size: 0.95rem; line-height: 1.8; color: #555;">
        <div><strong>é¡Œç›®ï¼š</strong><span id="detail-topic"></span></div>
        <div><strong>ç­åˆ¥ï¼š</strong><span id="detail-class"></span></div>
        <div><strong>é€²åº¦ï¼š</strong><span id="detail-count"></span></div>
        <div style="border-top: 1px dashed #eee; margin: 8px 0;"></div>
        <div style="font-size: 0.85rem; color: #999;">
            å»ºç«‹æ—¥æœŸï¼š<span id="detail-create-date"></span><br>
            æœ€å¾Œæ›´æ–°ï¼š<span id="detail-update-date"></span>
        </div>
    </div>

    <!-- å·²æœ‰å­¸ç”Ÿåå–®é è¦½ -->
    <div class="pop-scroll-area" id="detail-student-list" style="height: 150px; background: #fafafa; border: 1px solid #eee;">
        <!-- JS å‹•æ…‹å¡«å…¥ -->
    </div>

    <div class="pop-footer" style="justify-content: space-between;">
        <button class="pop-btn danger-btn" onclick="deleteProjectFromDetails()" style="background:#ffebee; color:#c62828;">ğŸ—‘ï¸ åˆªé™¤æ­¤ä½œæ¥­</button>
        <button class="pop-btn pop-btn-confirm" onclick="document.getElementById('pop-project-details-modal').classList.remove('active')">é—œé–‰</button>
    </div>
  </div>
</div>
<script>
    (function() {
        const gate = document.getElementById('login-gate');
        // æª¢æŸ¥æœ¬åœ°æ˜¯å¦æ¨™è¨˜ç‚ºã€Œå·²ç™»å…¥ã€
        if (localStorage.getItem('idw_is_logged_in') === 'yes') {
            // ç«‹å³é–‹é–€ (åŠ ä¸Š unlocked class)
            if (gate) gate.classList.add('unlocked');
        }
    })();
</script>

<!-- [v11.3] Header ä¿®æ”¹æŒ‡å¼• (è«‹æ‰‹å‹•èª¿æ•´ Header HTML) -->
<!-- 
1. åˆªé™¤ <div class="header-actions">...</div>
2. å°‡ <button ... onclick="toggleSettingsMenu()">âš™ï¸</button> æ”¾å…¥ <div id="auth-buttons"> å…§
3. å°‡ <div id="settings-dropdown">...</div> ä¹Ÿæ”¾å…¥ <div id="auth-buttons"> å…§ (æˆ–è€…æ”¾åœ¨ header åº•éƒ¨)
-->

<!-- [v11.3] å®Œæ•´ç‰ˆå¿«é€Ÿæ–°å¢è©•èª Modal -->
<div id="pop-instant-add-modal" class="pop-overlay">
  <div class="pop-modal" style="max-width: 500px; max-height: 90vh; display:flex; flex-direction:column;">
    <div class="pop-icon">âœ¨</div>
    <h3>æ–°å¢è©•èªè©³æƒ…</h3>
    <p class="pop-desc" id="instant-add-category-display">é¡åˆ¥ï¼šå…§å®¹</p>
    <input type="hidden" id="instant-add-category-val">

    <!-- æ²å‹•å€åŸŸ -->
    <div class="pop-scroll-area" style="text-align: left; padding: 15px;">
        
        <!-- æ¨™é¡Œèˆ‡é¡å‹ -->
        <label style="font-size:0.85rem; font-weight:bold; color:#5A8F7B;">æ¨™é¡Œ (å¿…å¡«)</label>
        <input type="text" id="instant-add-title" class="pop-input" style="margin-bottom: 15px;" placeholder="ä¾‹å¦‚ï¼šç«‹æ„æ·±åˆ»">
        
        <label style="font-size:0.85rem; font-weight:bold; color:#666;">é¡å‹</label>
        <div style="display:flex; gap:10px; margin-bottom: 20px;">
            <label style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px; cursor:pointer; text-align:center; background:#fff;">
                <input type="radio" name="instant-add-type" value="excellent" checked onchange="toggleInstantAddFields()"> ğŸ‘ å„ªé»
            </label>
            <label style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px; cursor:pointer; text-align:center; background:#fff;">
                <input type="radio" name="instant-add-type" value="problem" onchange="toggleInstantAddFields()"> ğŸ‘ å¾…æ”¹é€²
            </label>
        </div>

        <!-- å„ªé»å°ˆç”¨ -->
        <div id="instant-field-excellent">
            <label style="font-size:0.85rem; font-weight:bold; color:#666;">å„ªé»è©³æƒ…</label>
            <textarea id="instant-add-strength" class="pop-input" rows="2" placeholder="å°å„ªé»çš„å…·é«”æè¿°..."></textarea>
        </div>

        <!-- ç¼ºé»å°ˆç”¨ (é è¨­éš±è—) -->
        <div id="instant-field-problem" style="display:none;">
            <label style="font-size:0.85rem; font-weight:bold; color:#c86a5a;">å•é¡Œæ ¸å¿ƒ</label>
            <textarea id="instant-add-problem" class="pop-input" rows="2" placeholder="å•é¡Œåœ¨æ–¼..."></textarea>
            
            <label style="font-size:0.85rem; font-weight:bold; color:#5A8F7B; margin-top:10px;">å»ºè­° (å®œ)</label>
            <textarea id="instant-add-suggestion" class="pop-input" rows="2" placeholder="å»ºè­°å¦‚ä½•æ”¹å–„..."></textarea>
        </div>

        <!-- é€šç”¨æ¬„ä½ -->
        <div style="margin-top: 15px; border-top: 1px dashed #ddd; padding-top: 15px;">
            <label style="font-size:0.85rem; font-weight:bold; color:#666;">ä¾‹å­ (Example)</label>
            <textarea id="instant-add-example" class="pop-input" rows="2" placeholder="å…·é«”ä¾‹å­..."></textarea>

            <label style="font-size:0.85rem; font-weight:bold; color:#666; margin-top:10px;">ä¸‹æ‹‰é¸é …è¨­å®š (é€²éš)</label>
            <input type="text" id="instant-add-options-label" class="pop-input" placeholder="æ¨™ç±¤ (e.g. æå¯«å°è±¡)" style="margin-bottom:5px;">
            <textarea id="instant-add-options" class="pop-input" rows="2" placeholder="é¸é … (æ¯è¡Œä¸€å€‹ï¼Œe.g. å¤©æ°£|å¿ƒæƒ…)"></textarea>
            <div style="font-size:0.75rem; color:#999;">è¨»ï¼šå¯ç”¨ | åˆ†éš”å¤šçµ„é¸é …</div>
        </div>
    </div>

    <div class="pop-footer">
      <button class="pop-btn pop
